(()=>{var M=class{count=0;increment(){this.count++}decrement(){this.count--}};var R=class{items=[];addNewItem(n){this.items.push(n)}};var d=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(n,t){this.$_callbacks&&n in this.$_callbacks&&this.$_callbacks[n](t)}};var F=class extends d{_name="MenuBar"};function S(e){var n=e+"";return n.length}var U=class extends d{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},ie=[function(e){return function(n){e.decrement()}},function(e){return e.count%10+12},function(e){return`
    Count `+e.count+" "+S(e.message)+`
`},function(e){return`
Count `+e.count+" "+S(e.message)+`
`},function(e){return function(n){e.increment()}},function(e){return function(n){e.increment(n)}},function(e){return e.increment.bind(e)},function(e){return e.message}];var W=class extends d{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},ce=[function(e){return e.title},function(e){return e.title}];var G=class extends d{_name="Layout";title="Viewi"},ue=[function(e){return`
        `+e.title+` | Viewi
    `}];var j=class extends d{_name="NotFoundPage"};var q=class extends d{_name="CounterPage"};var z=class extends d{_name="TodoAppPage"};var J=class extends d{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(n){super(),this.count=n===void 0?0:n,this.counter=new M}$calculate(){this.count++}},se=[function(e){return function(n){e.counter.decrement()}},function(e){return e.__id},function(e){return e.counter.count},function(e){return function(n){e.counter.increment()}}];function L(e,n){let t,r=0;if(e===null||typeof e>"u")return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;n==="COUNT_RECURSIVE"&&(n=1),n!==1&&(n=0);for(t in e)e.hasOwnProperty(t)&&(r++,n===1&&e[t]&&(e[t].constructor===Array||e[t].constructor===Object)&&(r+=L(e[t],1)));return r}var Q=class extends d{_name="StatefulTodoApp";text="";todo=null;constructor(n){super(),this.todo=n}handleSubmit(n){n.preventDefault(),S(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},ae=[function(e){return function(n){e.handleSubmit(n)}},function(e){return e.text},function(e){return`
        Add #`+(L(e.todo.items)+1)+`
    `},function(e){return e.todo.items}];var X=class extends d{_name="TestComponent";name="MyName";_name2_Test="MyName_2";empty="";null=null;url="/home";attr="title";event="(click)";arr=["a","b","c"];arrWithKeys={a:"Apple",b:"Orange",c:"Lemon"};arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},b:{a:"Apple",b:"Orange",c:"Lemon"},c:{a:"Apple",b:"Orange",c:"Lemon"}};ifValue=!0;ifElseValue=!0;getName(n){var t=60;return n??"DefaultName"}addTodo(){this.arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},d:{R:"Rat",T:"Dog",G:"Cat"},b:{a:"Apple",b:"Orange",c:"Lemon"}}}onEvent(n){n.preventDefault()}toggleIf(){this.ifValue=!this.ifValue}toggleElseIf(){this.ifElseValue=!this.ifElseValue}},me=[function(e){return"Tag test "+e.name+" "+e._name2_Test},function(e){return`
    $notAVar `+e.getName()+" "+e.getName(e.name)+`
    Nested
    `},function(e){return e.url},function(e){return e.empty},function(e){return e.null},function(e){return e.attr},function(e){return expression.bind(e)},function(e){return e.event},function(e){return e.onEvent.bind(e)},function(e){return e.addTodo.bind(e)},function(e){return e.arr},function(e,n,t){return t},function(e,n,t){return t},function(e,n,t){return t},function(e){return e.arr},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return n+". "},function(e,n,t){return t},function(e,n,t){return t},function(e){return e.arrWithKeys},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return n+": "},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return t},function(e){return e.ifValue},function(e){return e.arrNested},function(e,n,t){return t},function(e,n,t,r,o){return n},function(e,n,t,r,o){return r},function(e,n,t,r,o){return o},function(e,n,t,r,o){return n+". "+r+". "+o},function(e){return e.arrNested},function(e,n,t){return n==="b"},function(e,n,t){return t},function(e,n,t,r,o){return n},function(e,n,t,r,o){return r},function(e,n,t,r,o){return o},function(e,n,t,r,o){return n+". "+r+". "+o},function(e){return e.toggleIf.bind(e)},function(e){return e.toggleElseIf.bind(e)},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.arr},function(e,n,t){return t}];var Y=class extends d{_name="TodoApp";text="";items=[];handleSubmit(n){n.preventDefault(),S(this.text)!=0&&(this.items.push(this.text),this.text="")}},le=[function(e){return function(n){e.handleSubmit(n)}},function(e){return e.text},function(e){return`
        Add #`+(L(e.items)+1)+`
    `},function(e){return e.items}];var Z=class extends d{_name="TodoList";items=null},pe=[function(e){return e.items},function(e,n,t){return t}];var P={CounterReducer:M,TodoReducer:R,MenuBar:F,Counter_x:ie,Counter:U,HomePage_x:ce,HomePage:W,Layout_x:ue,Layout:G,NotFoundPage:j,CounterPage:q,TodoAppPage:z,StatefulCounter_x:se,StatefulCounter:J,StatefulTodoApp_x:ae,StatefulTodoApp:Q,TestComponent_x:me,TestComponent:X,TodoApp_x:le,TodoApp:Y,TodoList_x:pe,TodoList:Z};var _e=0,fe=0,H={};function A(e){return e.__aid||(e.__aid=++_e,H[e.__aid]={current:-1,target:e,invalid:[],added:0}),H[e.__aid]}function ee(){return++fe}function C(e,n=!1,t,r){let o=document.createTextNode("");return o._anchor=r??"#"+ ++fe,t&&t.current++,n||t&&e.childNodes.length>t.current?(t?e:e.parentElement).insertBefore(o,t?e.childNodes[t.current]:e):e.appendChild(o),o}function de(e){let n=new Proxy(e,{set(t,r,o){var c=t[r]!==o,u=Reflect.set(t,r,o);if(c&&r in t.$$r)for(let i in t.$$r[r]){let h=t.$$r[r][i];h[0].apply(null,h[1])}return u}});return e.$=e,n}function he(e,n){let t=A(e),r=e.childNodes.length,o=t.current+3;o=o>r?r:o;let c=[];for(let i=t.current+1;i<o;i++){let h=e.childNodes[i];if(h.nodeType===8)return t.current=i,t.invalid=t.invalid.concat(c),h;c.push(i)}t.added++,t.invalid=t.invalid.concat(c),console.log("Hydrate comment not found",n);let u=document.createComment(n);return t.current=t.current+c.length+1,r>t.current?e.insertBefore(u,e.childNodes[t.current]):e.appendChild(u)}function xe(e,n){let t=A(e),r=e.childNodes.length,o=t.current+3;o=o>r?r:o;let c=[];for(let i=t.current+1;i<o;i++){let h=e.childNodes[i];if(h.nodeType===1&&h.nodeName.toLowerCase()===n)return t.current=i,t.invalid=t.invalid.concat(c),h;c.push(i)}t.added++,t.invalid=t.invalid.concat(c),console.warn("Hydrate not found",n);let u=document.createElement(n);return t.current=t.current+c.length+1,r>t.current?e.insertBefore(u,e.childNodes[t.current]):e.appendChild(u)}function V(e,n,t,r){let o=[e];r&&(o=o.concat(r.arguments));let c=n.expression?e.$$t[n.code].apply(null,o):n.content??"";t.nodeValue!==c&&(t.nodeValue=c)}function be(e,n,t,r){let o=A(e),c=e.childNodes.length,u=o.current+3;u=u>c?c:u;let i=[],h=o.current>-1?o.current:o.current+1;for(let s=h;s<u;s++){let v=e.childNodes[s];if(v.nodeType===3){if(s===o.current)break;return o.current=s,o.invalid=o.invalid.concat(i),V(n,t,v,r),v}s!==o.current&&i.push(s)}o.added++,o.invalid=o.invalid.concat(i);let g=document.createTextNode("");return V(n,t,g,r),o.current=o.current+i.length+1,c>o.current?e.insertBefore(g,e.childNodes[o.current]):e.appendChild(g)}function te(e,n,t,r,o){let c=null;if(n.children){c="";for(let u=0;u<n.children.length;u++){let i=n.children[u],h=[e];o&&(h=h.concat(o.arguments));let g=i.expression?e.$$t[i.code].apply(null,h):i.content??"";c=u===0?g:c+(g??"")}}c!==null?c!==t.getAttribute(r)&&t.setAttribute(r,c):t.removeAttribute(r)}function ve(e,n,t,r,o,c,u){let i=[e];u&&(i=i.concat(u.arguments));let h=e.$$t[t.children[0].forData].apply(null,i),g=Array.isArray(h),s=r,v=!1,_={},D={};for(let l in h){let a=g?+l:l,b=h[a],f=u?{map:{...u.map},arguments:[...u.arguments],components:[],track:[]}:{map:{},arguments:[],components:[],track:[]},m=!1;for(let p in o)if(o[p]===b){m=!0,v=!1,s=r;break}else!v&&!(a in _)&&(s=o[p].begin,v=!0);if(_[a]=!0,!m){f.map[t.children[0].forKey]=f.arguments.length,f.arguments.push(a),f.map[t.children[0].forItem]=f.arguments.length,f.arguments.push(b);let p={map:{...c.map},storage:{...c.storage}},x=C(s,!0,void 0,"b"+ee());k(s,e,[n],f,p,!1,!0);let y=C(s,!0,void 0,x._anchor);a in o&&(D[a]=o[a]),o[a]={key:a,value:b,begin:x,end:y}}}for(let l in o)if(!(l in _)){let a=o[l].end;for(;a.previousSibling._anchor!==a._anchor;)a.previousSibling.remove();o[l].begin.remove(),a.remove(),delete o[l]}for(let l in D){let a=D[l].end;for(;a.previousSibling._anchor!==a._anchor;)a.previousSibling.remove();D[l].begin.remove(),a.remove()}}function ne(e,n,t,r,o,c,u){let i=!0;for(let g=0;g<u;g++)i=i&&!o.values[g];t.children&&(i=i&&!!e.$$t[t.children[0].code](e));let h={map:{...c.map},storage:{...c.storage}};if(o.values[u]!==i)if(o.values[u]=i,i)k(r,e,[n],{arguments:[],components:[],track:[],map:{}},h,!1,!0);else for(;r.previousSibling._anchor!==r._anchor;)r.previousSibling.remove()}var Ae=0;function B(e,n,t){e.$$r[n]||(e.$$r[n]={}),e.$$r[n][++Ae]=t}function ge(e,n,t){let r=n.expression?e.$$t[n.code](e):n.content??"";t.nodeValue!==r&&(t.nodeValue=r)}function k(e,n,t,r,o,c=!0,u=!1){let i=null,h=!1;for(let g=0;g<t.length;g++){let s=t[g],v=e,_=!1,D=!1;switch(s.type){case"tag":{if(s.directives){let a=o||{map:{},storage:{}},b=[n];r&&(b=b.concat(r.arguments));for(let f=0;f<s.directives.length;f++){let m=s.directives[f];if(!(f in a.map)){switch(a.map[f]=!0,m.content){case"if":{i={values:[],index:0,subs:[]};let p=!!n.$$t[m.children[0].code].apply(null,b);i.values.push(p);let x=c?A(e):void 0,y=C(e,u,x),w={map:{...a.map},storage:{...a.storage}};p&&k(e,n,[s],r,a,c,u);let $=C(e,u,x,y._anchor);if(m.children[0].subs)for(let T in m.children[0].subs){let N=m.children[0].subs[T];i.subs.push(N),B(n,N,[ne,[n,s,m,$,i,w,i.index]])}i.index++,_=!0;break}case"else-if":{if(i){let p=!0;for(let T=0;T<i.index;T++)p=p&&!i.values[T];p=p&&!i.values[i.index-1]&&!!n.$$t[m.children[0].code].apply(null,b),i.values.push(p);let x=c?A(e):void 0,y=C(e,u,x),w={map:{...a.map},storage:{...a.storage}};p&&k(e,n,[s],r,a,c,u);let $=C(e,u,x,y._anchor);m.children[0].subs&&(i.subs=i.subs.concat(m.children[0].subs));for(let T in i.subs){let N=i.subs[T];B(n,N,[ne,[n,s,m,$,i,w,i.index]])}i.index++,_=!0}else console.warn("Directive else-if has missing previous if/else-if",m.content,m);break}case"else":{if(i){let p=!0;for(let T=0;T<i.index;T++)p=p&&!i.values[T];i.values.push(p);let x=c?A(e):void 0,y=C(e,u,x),w={map:{...a.map},storage:{...a.storage}};p&&k(e,n,[s],r,a,c,u);let $=C(e,u,x,y._anchor);for(let T in i.subs){let N=i.subs[T];B(n,N,[ne,[n,s,m,$,i,w,i.index]])}i.index++,_=!0}else console.warn("Directive else has missing previous if/else-if",m.content,m);break}case"foreach":{let p=n.$$t[m.children[0].forData].apply(null,b),x=c?A(e):void 0,y=C(e,u,x),w=Array.isArray(p),$={};for(let N in p){let I=w?+N:N,O=p[I],E=r?{map:{...r.map},arguments:[...r.arguments],components:[],track:[]}:{map:{},arguments:[],components:[],track:[]};E.map[m.children[0].forKey]=E.arguments.length,E.arguments.push(I),E.map[m.children[0].forItem]=E.arguments.length,E.arguments.push(O);let ye={map:{...a.map},storage:{...a.storage}},re=C(e,u,x,"b"+ee());k(e,n,[s],E,ye,c,u);let Ce=C(e,u,x,re._anchor);$[I]={key:I,value:O,begin:re,end:Ce}}let T=C(e,u,x,y._anchor);if(m.children[0].subs)for(let N in m.children[0].subs){let I=m.children[0].subs[N],O={map:{...a.map},storage:{...a.storage}};B(n,I,[ve,[n,s,m,T,$,O,r]])}_=!0;break}default:{console.warn("Directive not implemented",m.content,m),_=!0;break}}if(_)break}}if(_)continue}if(s.content==="template"){h=u;break}D=!0;let l=s.expression?n.$$t[s.code](n):s.content??"";v=c?xe(e,l):u?e.parentElement.insertBefore(document.createElement(l),e):e.appendChild(document.createElement(l));break}case"text":{let l;if(c?l=be(e,n,s,r):(l=document.createTextNode(""),V(n,s,l,r),u?e.parentElement.insertBefore(l,e):e.appendChild(l)),s.subs)for(let a in s.subs){let b=s.subs[a];B(n,b,[V,[n,s,l,r]])}break}case"comment":{let l=s.expression?n.$$t[s.code](n):s.content??"",a=c?he(e,l):u?e.parentElement.insertBefore(document.createComment(l),e):e.appendChild(document.createComment(l));if(s.subs)for(let b in s.subs){let f=s.subs[b];B(n,f,[ge,[n,s,a]])}break}default:{console.warn("Node type not implemented",s);break}}if(D){if(s.attributes){let l=c?v.getAttributeNames():null,a=c?{}:null;for(let b in s.attributes){let f=s.attributes[b],m=f.expression?n.$$t[f.code](n):f.content??"";if(m[0]==="("){let p=m.substring(1,m.length-1);if(f.children){let x=n.$$t[f.dynamic?f.dynamic.code:f.children[0].code](n);v.addEventListener(p,x)}}else{c&&(a[m]=!0),te(n,f,v,m,r);let p=[];if(f.children)for(let x in f.children){let y=f.children[x];y.subs&&(p=p.concat(y.subs))}if(p)for(let x in p){let y=p[x];B(n,y,[te,[n,f,v,m,r]])}}}if(c)for(let b=0;b<l.length;b++)l[b]in a||v.removeAttribute(l[b])}else if(c){let l=v.getAttributeNames();for(let a=0;a<l.length;a++)v.removeAttribute(l[a])}}s.children&&k(v,n,s.children,r,void 0,c,h)}}function K(e){let n="value";switch(e.t){case"t":{n="tag";break}case"a":{n="attr";break}case void 0:case"v":{n="value";break}case"c":{n="component";break}case"x":{n="text";break}case"m":{n="comment";break}case"r":{n="root";break}default:throw new Error("Type "+e.t+" is not defined in build")}if(e.type=n,delete e.t,e.c&&(e.content=e.c,delete e.c),e.e&&(e.expression=e.e,delete e.e),e.a){e.attributes=e.a,delete e.a;for(let t in e.attributes)K(e.attributes[t])}if(e.i){e.directives=e.i,delete e.i;for(let t in e.directives)K(e.directives[t])}if(e.h){e.children=e.h,delete e.h;for(let t in e.children)K(e.children[t])}}var oe={},ke=()=>({version:"2.0.1"});globalThis.Viewi=ke;console.log("Viewi entry");var Te=document.getElementById("counter");function $e(e){if(!(e in oe))throw new Error(`Component ${e} not found.`);if(!(e in P))throw new Error(`Component ${e} not found.`);let n=oe[e].nodes,t=de(new P[e]),r=e+"_x";if(r in P&&(t.$$t=P[r]),Te&&n){n.unpacked||(K(n),n.unpacked=!0);let o=n.children;o&&k(Te,t,o,{arguments:[],components:[],map:{},track:[]})}for(let o in H){let c=H[o];for(let u=c.target.childNodes.length-1;u>=c.current+1;u--)c.target.childNodes[u].remove();for(let u=c.invalid.length-1;u>=0;u--)c.target.childNodes[c.invalid[u]].remove()}}(async()=>(oe=await(await fetch("/assets/components.json")).json(),setTimeout(()=>$e("TestComponent"),500)))();})();
