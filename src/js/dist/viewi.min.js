(()=>{var w=class{count=0;increment(){this.count++}decrement(){this.count--}};var K=class{items=[];addNewItem(t){this.items.push(t)}};var h=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(t,n){this.$_callbacks&&t in this.$_callbacks&&this.$_callbacks[t](n)}};var O=class extends h{_name="MenuBar"};function E(e){var t=e+"";return t.length}var F=class extends h{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},te=[function(e){return function(t){e.decrement()}},function(e){return e.count%10+12},function(e){return`
    Count `+e.count+" "+E(e.message)+`
`},function(e){return`
Count `+e.count+" "+E(e.message)+`
`},function(e){return function(t){e.increment()}},function(e){return function(t){e.increment(t)}},function(e){return e.increment.bind(e)},function(e){return e.message}];var R=class extends h{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},ne=[function(e){return e.title},function(e){return e.title}];var U=class extends h{_name="Layout";title="Viewi"},oe=[function(e){return`
        `+e.title+` | Viewi
    `}];var W=class extends h{_name="NotFoundPage"};var j=class extends h{_name="CounterPage"};var q=class extends h{_name="TodoAppPage"};var z=class extends h{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(t){super(),this.count=t===void 0?0:t,this.counter=new w}$calculate(){this.count++}},re=[function(e){return function(t){e.counter.decrement()}},function(e){return e.__id},function(e){return e.counter.count},function(e){return function(t){e.counter.increment()}}];function I(e,t){let n,i=0;if(e===null||typeof e>"u")return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;t==="COUNT_RECURSIVE"&&(t=1),t!==1&&(t=0);for(n in e)e.hasOwnProperty(n)&&(i++,t===1&&e[n]&&(e[n].constructor===Array||e[n].constructor===Object)&&(i+=I(e[n],1)));return i}var G=class extends h{_name="StatefulTodoApp";text="";todo=null;constructor(t){super(),this.todo=t}handleSubmit(t){t.preventDefault(),E(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},ie=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return`
        Add #`+(I(e.todo.items)+1)+`
    `},function(e){return e.todo.items}];var J=class extends h{_name="TestComponent";name="MyName";_name2_Test="MyName_2";empty="";null=null;url="/home";attr="title";event="(click)";arr=["a","b","c"];arrWithKeys={a:"Apple",b:"Orange",c:"Lemon"};arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},b:{a:"Apple",b:"Orange",c:"Lemon"},c:{a:"Apple",b:"Orange",c:"Lemon"}};ifValue=!0;ifElseValue=!0;getName(t){var n=60;return t??"DefaultName"}addTodo(){this.arr=[...this.arr,"Viewi"]}onEvent(t){t.preventDefault()}toggleIf(){this.ifValue=!this.ifValue}toggleElseIf(){this.ifElseValue=!this.ifElseValue}},ue=[function(e){return"Tag test "+e.name+" "+e._name2_Test},function(e){return`
    $notAVar `+e.getName()+" "+e.getName(e.name)+`
    Nested
    `},function(e){return e.url},function(e){return e.empty},function(e){return e.null},function(e){return e.attr},function(e){return expression.bind(e)},function(e){return e.event},function(e){return e.onEvent.bind(e)},function(e){return e.addTodo.bind(e)},function(e){return e.arr},function(e,t,n){return n},function(e,t,n){return n},function(e,t,n){return n},function(e){return e.arr},function(e,t,n){return t},function(e,t,n){return n},function(e,t,n){return t+". "},function(e,t,n){return n},function(e,t,n){return n},function(e){return e.arrWithKeys},function(e,t,n){return t},function(e,t,n){return n},function(e,t,n){return t+": "},function(e,t,n){return t},function(e,t,n){return n},function(e,t,n){return n},function(e){return e.arrNested},function(e,t,n){return n},function(e,t,n,i,o){return t},function(e,t,n,i,o){return i},function(e,t,n,i,o){return o},function(e,t,n,i,o){return t+". "+i+". "+o},function(e){return e.arrNested},function(e,t,n){return t==="b"},function(e,t,n){return n},function(e,t,n,i,o){return t},function(e,t,n,i,o){return i},function(e,t,n,i,o){return o},function(e,t,n,i,o){return t+". "+i+". "+o},function(e){return e.toggleIf.bind(e)},function(e){return e.toggleElseIf.bind(e)},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.arr},function(e,t,n){return n}];var Q=class extends h{_name="TodoApp";text="";items=[];handleSubmit(t){t.preventDefault(),E(this.text)!=0&&(this.items.push(this.text),this.text="")}},ce=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return`
        Add #`+(I(e.items)+1)+`
    `},function(e){return e.items}];var X=class extends h{_name="TodoList";items=null},se=[function(e){return e.items},function(e,t,n){return n}];var M={CounterReducer:w,TodoReducer:K,MenuBar:O,Counter_x:te,Counter:F,HomePage_x:ne,HomePage:R,Layout_x:oe,Layout:U,NotFoundPage:W,CounterPage:j,TodoAppPage:q,StatefulCounter_x:re,StatefulCounter:z,StatefulTodoApp_x:ie,StatefulTodoApp:G,TestComponent_x:ue,TestComponent:J,TodoApp_x:ce,TodoApp:Q,TodoList_x:se,TodoList:X};var Te=0,V={};function A(e){return e.__aid||(e.__aid=++Te,V[e.__aid]={current:-1,target:e,invalid:[],added:0}),V[e.__aid]}function $(e,t=!1,n,i){let o=document.createTextNode("");return o._anchor=i??"#",n&&n.current++,t||n&&e.childNodes.length>n.current?(n?e:e.parentElement).insertBefore(o,n?e.childNodes[n.current]:e):e.appendChild(o),o}function le(e){let t=new Proxy(e,{set(n,i,o){var s=n[i]!==o,u=Reflect.set(n,i,o);if(s&&i in n.$$r)for(let r in n.$$r[i]){let d=n.$$r[i][r];d[0].apply(null,d[1])}return u}});return e.$=e,t}function ae(e,t){let n=A(e),i=e.childNodes.length,o=n.current+3;o=o>i?i:o;let s=[];for(let r=n.current+1;r<o;r++){let d=e.childNodes[r];if(d.nodeType===8)return n.current=r,n.invalid=n.invalid.concat(s),d;s.push(r)}n.added++,n.invalid=n.invalid.concat(s),console.log("Hydrate comment not found",t);let u=document.createComment(t);return n.current=n.current+s.length+1,i>n.current?e.insertBefore(u,e.childNodes[n.current]):e.appendChild(u)}function me(e,t){let n=A(e),i=e.childNodes.length,o=n.current+3;o=o>i?i:o;let s=[];for(let r=n.current+1;r<o;r++){let d=e.childNodes[r];if(d.nodeType===1&&d.nodeName.toLowerCase()===t)return n.current=r,n.invalid=n.invalid.concat(s),d;s.push(r)}n.added++,n.invalid=n.invalid.concat(s),console.warn("Hydrate not found",t);let u=document.createElement(t);return n.current=n.current+s.length+1,i>n.current?e.insertBefore(u,e.childNodes[n.current]):e.appendChild(u)}function S(e,t,n,i){let o=[e];i&&(o=o.concat(i.arguments));let s=t.expression?e.$$t[t.code].apply(null,o):t.content??"";n.nodeValue!==s&&(n.nodeValue=s)}function fe(e,t,n,i){let o=A(e),s=e.childNodes.length,u=o.current+3;u=u>s?s:u;let r=[],d=o.current>-1?o.current:o.current+1;for(let c=d;c<u;c++){let v=e.childNodes[c];if(v.nodeType===3){if(c===o.current)break;return o.current=c,o.invalid=o.invalid.concat(r),S(t,n,v,i),v}c!==o.current&&r.push(c)}o.added++,o.invalid=o.invalid.concat(r);let N=document.createTextNode("");return S(t,n,N,i),o.current=o.current+r.length+1,s>o.current?e.insertBefore(N,e.childNodes[o.current]):e.appendChild(N)}function Z(e,t,n,i,o){let s=null;if(t.children){s="";for(let u=0;u<t.children.length;u++){let r=t.children[u],d=[e];o&&(d=d.concat(o.arguments));let N=r.expression?e.$$t[r.code].apply(null,d):r.content??"";s=u===0?N:s+(N??"")}}s!==null?s!==n.getAttribute(i)&&n.setAttribute(i,s):n.removeAttribute(i)}function pe(e,t,n,i,o,s,u){let r=[e];u&&(r=r.concat(u.arguments));let d=e.$$t[n.children[0].forData].apply(null,r),N=Array.isArray(d),c=i,v=!1,_={},k={};for(let l in d){let m=N?+l:l,x=d[m],p=u?{map:{...u.map},arguments:[...u.arguments]}:{map:{},arguments:[]},a=!1;for(let f in o)if(o[f]===x){a=!0,v=!1,c=i;break}else!v&&!(m in _)&&(c=o[f].begin,v=!0);if(_[m]=!0,!a){p.map[n.children[0].forKey]=p.arguments.length,p.arguments.push(m),p.map[n.children[0].forItem]=p.arguments.length,p.arguments.push(x);let f={map:{...s.map},storage:{...s.storage}},b=$(c,!0,void 0,"b");C(c,e,[t],f,!1,!0,p);let T=$(c,!0,void 0,"e");m in o&&(k[m]=o[m]),o[m]={key:m,value:x,begin:b,end:T}}}for(let l in o)if(!(l in _)){for(;o[l].end.previousSibling._anchor!=="b";)o[l].end.previousSibling.remove();o[l].begin.remove(),o[l].end.remove(),delete o[l]}for(let l in k){for(;k[l].end.previousSibling._anchor!=="b";)k[l].end.previousSibling.remove();k[l].begin.remove(),k[l].end.remove()}}function Y(e,t,n,i,o,s,u){let r=!0;for(let d=0;d<u;d++)r=r&&!o.values[d];if(n.children&&(r=r&&!!e.$$t[n.children[0].code](e)),o.values[u]!==r)if(o.values[u]=r,r)C(i,e,[t],{...s},!1,!0);else for(;!i.previousSibling._anchor;)i.previousSibling.remove()}function de(e,t,n){let i=t.expression?e.$$t[t.code](e):t.content??"";n.nodeValue!==i&&(n.nodeValue=i)}function C(e,t,n,i,o=!0,s=!1,u){let r=null,d=!1;for(let N=0;N<n.length;N++){let c=n[N],v=e,_=!1,k=!1;switch(c.type){case"tag":{if(c.directives){let m=i||{map:{},storage:{}},x=[t];u&&(x=x.concat(u.arguments));for(let p=0;p<c.directives.length;p++){let a=c.directives[p];if(!(p in m.map)){switch(m.map[p]=!0,a.content){case"if":{r={values:[],index:0,subs:[]};let f=!!t.$$t[a.children[0].code].apply(null,x);r.values.push(f);let b=A(e);$(e,!1,b),f&&C(e,t,[c],m,o,s,u);let T=$(e,!1,b);if(a.children[0].subs)for(let g in a.children[0].subs){let y=a.children[0].subs[g];r.subs.push(y),t.$$r[y]||(t.$$r[y]=[]),t.$$r[y].push([Y,[t,c,a,T,r,{...m},r.index]])}r.index++,_=!0;break}case"else-if":{if(r){let f=!0;for(let g=0;g<r.index;g++)f=f&&!r.values[g];f=f&&!r.values[r.index-1]&&!!t.$$t[a.children[0].code].apply(null,x),r.values.push(f);let b=A(e);$(e,!1,b),f&&C(e,t,[c],m,o,s,u);let T=$(e,!1,b);a.children[0].subs&&(r.subs=r.subs.concat(a.children[0].subs));for(let g in r.subs){let y=r.subs[g];t.$$r[y]||(t.$$r[y]=[]),t.$$r[y].push([Y,[t,c,a,T,r,{...m},r.index]])}r.index++,_=!0}else console.warn("Directive else-if has missing previous if/else-if",a.content,a);break}case"else":{if(r){let f=!0;for(let g=0;g<r.index;g++)f=f&&!r.values[g];r.values.push(f);let b=A(e);$(e,!1,b),f&&C(e,t,[c],m,o,s,u);let T=$(e,!1,b);for(let g in r.subs){let y=r.subs[g];t.$$r[y]||(t.$$r[y]=[]),t.$$r[y].push([Y,[t,c,a,T,r,{...m},r.index]])}r.index++,_=!0}else console.warn("Directive else has missing previous if/else-if",a.content,a);break}case"foreach":{let f=t.$$t[a.children[0].forData].apply(null,x),b=A(e);$(e,!1,b);let T=Array.isArray(f),g={};for(let P in f){let B=T?+P:P,H=f[B],D=u?{map:{...u.map},arguments:[...u.arguments]}:{map:{},arguments:[]};D.map[a.children[0].forKey]=D.arguments.length,D.arguments.push(B),D.map[a.children[0].forItem]=D.arguments.length,D.arguments.push(H);let xe={map:{...m.map},storage:{...m.storage}},be=$(e,!1,b,"b");C(e,t,[c],xe,o,s,D);let ve=$(e,!1,b,"e");g[B]={key:B,value:H,begin:be,end:ve}}let y=$(e,!1,b);if(a.children[0].subs)for(let P in a.children[0].subs){let B=a.children[0].subs[P];t.$$r[B]||(t.$$r[B]=[]);let H={map:{...m.map},storage:{...m.storage}};t.$$r[B].push([pe,[t,c,a,y,g,H,u]])}_=!0;break}default:{console.warn("Directive not implemented",a.content,a),_=!0;break}}if(_)break}}if(_)continue}if(c.content==="template"){d=s;break}k=!0;let l=c.expression?t.$$t[c.code](t):c.content??"";v=o?me(e,l):s?e.parentElement.insertBefore(document.createElement(l),e):e.appendChild(document.createElement(l));break}case"text":{let l;if(o?l=fe(e,t,c,u):(l=document.createTextNode(""),S(t,c,l,u),s?e.parentElement.insertBefore(l,e):e.appendChild(l)),c.subs)for(let m in c.subs){let x=c.subs[m];t.$$r[x]||(t.$$r[x]=[]),t.$$r[x].push([S,[t,c,l,u]])}break}case"comment":{let l=c.expression?t.$$t[c.code](t):c.content??"",m=o?ae(e,l):s?e.parentElement.insertBefore(document.createComment(l),e):e.appendChild(document.createComment(l));if(c.subs)for(let x in c.subs){let p=c.subs[x];t.$$r[p]||(t.$$r[p]=[]),t.$$r[p].push([de,[t,c,m]])}break}default:{console.warn("Node type not implemented",c);break}}if(k){if(c.attributes){let l=o?v.getAttributeNames():null,m=o?{}:null;for(let x in c.attributes){let p=c.attributes[x],a=p.expression?t.$$t[p.code](t):p.content??"";if(a[0]==="("){let f=a.substring(1,a.length-1);if(p.children){let b=t.$$t[p.dynamic?p.dynamic.code:p.children[0].code](t);v.addEventListener(f,b)}}else{o&&(m[a]=!0),Z(t,p,v,a,u);let f=[];if(p.children)for(let b in p.children){let T=p.children[b];T.subs&&(f=f.concat(T.subs))}if(f)for(let b in f){let T=f[b];t.$$r[T]||(t.$$r[T]=[]),t.$$r[T].push([Z,[t,p,v,a,u]])}}}if(o)for(let x=0;x<l.length;x++)l[x]in m||v.removeAttribute(l[x])}else if(o){let l=v.getAttributeNames();for(let m=0;m<l.length;m++)v.removeAttribute(l[m])}}c.children&&C(v,t,c.children,void 0,o,d,u)}}function L(e){let t="value";switch(e.t){case"t":{t="tag";break}case"a":{t="attr";break}case void 0:case"v":{t="value";break}case"c":{t="component";break}case"x":{t="text";break}case"m":{t="comment";break}case"r":{t="root";break}default:throw new Error("Type "+e.t+" is not defined in build")}if(e.type=t,delete e.t,e.c&&(e.content=e.c,delete e.c),e.e&&(e.expression=e.e,delete e.e),e.a){e.attributes=e.a,delete e.a;for(let n in e.attributes)L(e.attributes[n])}if(e.i){e.directives=e.i,delete e.i;for(let n in e.directives)L(e.directives[n])}if(e.h){e.children=e.h,delete e.h;for(let n in e.children)L(e.children[n])}}var ee={},ye=()=>({version:"2.0.1"});globalThis.Viewi=ye;console.log("Viewi entry");var he=document.getElementById("counter");function $e(e){if(!(e in ee))throw new Error(`Component ${e} not found.`);if(!(e in M))throw new Error(`Component ${e} not found.`);let t=ee[e].nodes,n=le(new M[e]),i=e+"_x";if(i in M&&(n.$$t=M[i]),he&&t){t.unpacked||(L(t),t.unpacked=!0);let o=t.children;o&&C(he,n,o)}for(let o in V){let s=V[o];for(let u=s.target.childNodes.length-1;u>=s.current+1;u--)s.target.childNodes[u].remove();for(let u=s.invalid.length-1;u>=0;u--)s.target.childNodes[s.invalid[u]].remove()}}(async()=>(ee=await(await fetch("/assets/components.json")).json(),setTimeout(()=>$e("TestComponent"),500)))();})();
