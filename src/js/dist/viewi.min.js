(()=>{var h=class{count=0;increment(){this.count++}decrement(){this.count--}};var _=class{items=[];addNewItem(t){this.items.push(t)}};var c=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(t,n){this.$_callbacks&&t in this.$_callbacks&&this.$_callbacks[t](n)}};var C=class extends c{_name="MenuBar"};function p(e){var t=e+"";return t.length}var g=class extends c{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},R=[function(e){return function(t){e.decrement()}},function(e){return e.count%10+12},function(e){return e.count},function(e){return p(e.message)},function(e){return e.count},function(e){return p(e.message)},function(e){return function(t){e.increment()}},function(e){return function(t){e.increment(t)}},function(e){return e.increment.bind(e)},function(e){return e.message}];var $=class extends c{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},D=[function(e){return e.title},function(e){return e.title}];var v=class extends c{_name="Layout";title="Viewi"},V=[function(e){return e.title}];var N=class extends c{_name="NotFoundPage"};var k=class extends c{_name="CounterPage"};var B=class extends c{_name="TodoAppPage"};var E=class extends c{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(t){super(),this.count=t===void 0?0:t,this.counter=new h}$calculate(){this.count++}},U=[function(e){return function(t){e.counter.decrement()}},function(e){return e.__id},function(e){return e.counter.count},function(e){return function(t){e.counter.increment()}}];function b(e,t){let n,r=0;if(e===null||typeof e>"u")return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;t==="COUNT_RECURSIVE"&&(t=1),t!==1&&(t=0);for(n in e)e.hasOwnProperty(n)&&(r++,t===1&&e[n]&&(e[n].constructor===Array||e[n].constructor===Object)&&(r+=b(e[n],1)));return r}var A=class extends c{_name="StatefulTodoApp";text="";todo=null;constructor(t){super(),this.todo=t}handleSubmit(t){t.preventDefault(),p(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},K=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return b(e.todo.items)+1},function(e){return e.todo.items}];var L=class extends c{_name="TestComponent";name="MyName";_name2_Test="MyName_2";empty="";null=null;url="/home";attr="title";event="(click)";arr=["a","b","c"];arrWithKeys={a:"Apple",b:"Orange",c:"Lemon"};arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},b:{a:"Apple",b:"Orange",c:"Lemon"},c:{a:"Apple",b:"Orange",c:"Lemon"}};getName(t){return t??"DefaultName"}onEvent(t){t.preventDefault()}},W=[function(e){return e.name},function(e){return e._name2_Test},function(e){return e.getName()},function(e){return e.getName(e.name)},function(e){return e.url},function(e){return e.empty},function(e){return e.null},function(e){return e.attr},function(e){return e.expression.bind(e)},function(e){return e.event},function(e){return e.onEvent.bind(e)}];var w=class extends c{_name="TodoApp";text="";items=[];handleSubmit(t){t.preventDefault(),p(this.text)!=0&&(this.items.push(this.text),this.text="")}},j=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return b(e.items)+1},function(e){return e.items}];var H=class extends c{_name="TodoList";items=null},q=[function(e){return e.item}];var y={CounterReducer:h,TodoReducer:_,MenuBar:C,Counter_x:R,Counter:g,HomePage_x:D,HomePage:$,Layout_x:V,Layout:v,NotFoundPage:N,CounterPage:k,TodoAppPage:B,StatefulCounter_x:U,StatefulCounter:E,StatefulTodoApp_x:K,StatefulTodoApp:A,TestComponent_x:W,TestComponent:L,TodoApp_x:j,TodoApp:w,TodoList_x:q,TodoList:H};var Q=0,x={};function M(e){return e.__aid||(e.__aid=++Q,x[e.__aid]={current:-1,target:e,invalid:[],added:0}),x[e.__aid]}function z(e){let t=new Proxy(e,{set(n,r,o){var i=n[r]!==o,a=Reflect.set(n,r,o);if(i&&r in n.$$r)for(let u in n.$$r[r]){let s=n.$$r[r][u];s[0].apply(null,s[1])}return a}});return e.$=e,t}function G(e,t){let n=M(e),r=e.childNodes.length,o=n.current+3;o=o>r?r:o;let i=[];for(let u=n.current+1;u<o;u++){let s=e.childNodes[u];if(s.nodeType===1&&s.nodeName.toLowerCase()===t)return n.current=u,n.invalid=n.invalid.concat(i),s;i.push(u)}n.added++,console.log("Hydrate not found",t);let a=document.createElement(t);return n.current++,r>n.current?e.insertBefore(a,e.childNodes[n.current]):e.appendChild(document.createElement(t))}function T(e,t,n){let r=t.expression?e.$$t[t.code](e):t.content??"";n.nodeValue!==r&&(n.nodeValue=r)}function J(e,t,n){let r=M(e),o=e.childNodes.length,i=r.current+3;i=i>o?o:i;let a=[],u=r.current>-1?r.current:r.current+1;for(let m=u;m<i;m++){let l=e.childNodes[m];if(l.nodeType===3){if(m===r.current)break;return r.current=m,r.invalid=r.invalid.concat(a),T(t,n,l),l}m!==r.current&&a.push(m)}r.added++;let s=document.createTextNode("");return T(t,n,s),r.current++,console.log("Hydrate not found",s),o>r.current?e.insertBefore(s,e.childNodes[r.current]):e.appendChild(s)}function S(e,t,n,r){let o=null;if(t.children){o="";for(let i=0;i<t.children.length;i++){let a=t.children[i],u=a.expression?e.$$t[a.code](e):a.content??"";o=i===0?u:o+(u??"")}}o!==null?o!==n.getAttribute(r)&&n.setAttribute(r,o):n.removeAttribute(r)}function O(e,t,n){for(let r in n){let o=n[r],i=e,a=!0;switch(o.type){case"tag":{let u=o.expression?t.$$t[o.code](t):o.content??"";i=a?G(e,u):e.appendChild(document.createElement(u));break}case"text":{let u;if(a?u=J(e,t,o):(u=document.createTextNode(""),T(t,o,u),e.appendChild(u)),o.subs)for(let s in o.subs){let m=o.subs[s];t.$$r[m]||(t.$$r[m]=[]),t.$$r[m].push([T,[t,o,u]])}break}default:{console.log("No implemented",o);break}}if(o.attributes)for(let u in o.attributes){let s=o.attributes[u],m=s.expression?t.$$t[s.code](t):s.content??"";if(m[0]==="("){let l=m.substring(1,m.length-1);if(s.children){let f=t.$$t[s.dynamic?s.dynamic.code:s.children[0].code](t);i.addEventListener(l,f),console.log("Event",s,l,f)}}else{S(t,s,i,m);let l=[];if(s.children)for(let f in s.children){let d=s.children[f];d.subs&&(l=l.concat(d.subs))}if(l)for(let f in l){let d=l[f];t.$$r[d]||(t.$$r[d]=[]),t.$$r[d].push([S,[t,s,i,m]])}}}o.children&&O(i,t,o.children)}}function P(e){let t="value";switch(e.t){case"t":{t="tag";break}case"a":{t="attr";break}case void 0:case"v":{t="value";break}case"c":{t="component";break}case"x":{t="text";break}case"m":{t="comment";break}case"r":{t="root";break}default:throw new Error("Type "+e.t+" is not defined in build")}if(e.type=t,delete e.t,e.c&&(e.content=e.c,delete e.c),e.e&&(e.expression=e.e,delete e.e),e.a){e.attributes=e.a,delete e.a;for(let n in e.attributes)P(e.attributes[n])}if(e.h){e.children=e.h,delete e.h;for(let n in e.children)P(e.children[n])}}var F={},X=()=>({version:"2.0.1"});globalThis.Viewi=X;console.log("Viewi entry");var I=document.getElementById("counter");function Y(e){if(!(e in F))throw new Error(`Component ${e} not found.`);if(!(e in y))throw new Error(`Component ${e} not found.`);let t=F[e].nodes,n=z(new y[e]),r=e+"_x";if(r in y&&(n.$$t=y[r]),I&&t){t.unpacked||(P(t),t.unpacked=!0);let o=t.children;console.log(I,n,o),o&&O(I,n,o)}console.log(x);for(let o in x){let i=x[o];for(let a=i.invalid.length-1;a>=0;a--)i.target.childNodes[i.invalid[a]].remove();for(let a=i.current+1;a<i.target.childNodes.length;a++)i.target.childNodes[a].remove()}}(async()=>(F=await(await fetch("/assets/components.json")).json(),setTimeout(()=>Y("TestComponent"),500)))();})();
