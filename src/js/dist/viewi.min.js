(()=>{var V=class{count=0;increment(){this.count++}decrement(){this.count--}};var F=class{items=[];addNewItem(n){this.items.push(n)}};var f=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(n,t){this.$_callbacks&&n in this.$_callbacks&&this.$_callbacks[n](t)}};var U=class extends f{_name="MenuBar"};function M(e){var n=e+"";return n.length}var W=class extends f{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},ue=[function(e){return function(n){e.decrement()}},function(e){return e.count%10+12},function(e){return`
    Count `+e.count+" "+M(e.message)+`
`},function(e){return`
Count `+e.count+" "+M(e.message)+`
`},function(e){return function(n){e.increment()}},function(e){return function(n){e.increment(n)}},function(e){return e.increment.bind(e)},function(e){return e.message}];var G=class extends f{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},se=[function(e){return e.title},function(e){return e.title}];var J=class extends f{_name="Layout";title="Viewi"},ae=[function(e){return`
        `+e.title+` | Viewi
    `}];var j=class extends f{_name="NotFoundPage"};var q=class extends f{_name="CounterPage"};var z=class extends f{_name="TodoAppPage"};var Q=class extends f{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(n){super(),this.count=n===void 0?0:n,this.counter=new V}$calculate(){this.count++}},me=[function(e){return function(n){e.counter.decrement()}},function(e){return e.__id},function(e){return e.counter.count},function(e){return function(n){e.counter.increment()}}];function H(e,n){let t,o=0;if(e===null||typeof e>"u")return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;n==="COUNT_RECURSIVE"&&(n=1),n!==1&&(n=0);for(t in e)e.hasOwnProperty(t)&&(o++,n===1&&e[t]&&(e[t].constructor===Array||e[t].constructor===Object)&&(o+=H(e[t],1)));return o}var X=class extends f{_name="StatefulTodoApp";text="";todo=null;constructor(n){super(),this.todo=n}handleSubmit(n){n.preventDefault(),M(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},le=[function(e){return function(n){e.handleSubmit(n)}},function(e){return e.text},function(e){return`
        Add #`+(H(e.todo.items)+1)+`
    `},function(e){return e.todo.items}];var Y=class extends f{_name="TestComponent";name="MyName";_name2_Test="MyName_2";empty="";null=null;url="/home";attr="title";event="(click)";arr=["a","b","c"];arrWithKeys={a:"Apple",b:"Orange",c:"Lemon"};arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},b:{a:"Apple",b:"Orange",c:"Lemon"},c:{a:"Apple",b:"Orange",c:"Lemon"}};ifValue=!0;ifElseValue=!0;nestedIf=!0;getName(n){var t=60;return n??"DefaultName"}addTodo(){this.arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},d:{R:"Rat",T:"Dog",G:"Cat"},b:{a:"Apple",b:"Orange",c:"Lemon"}}}onEvent(n){n.preventDefault()}toggleIf(){this.ifValue=!this.ifValue,this.arr=this.ifValue?["a","b","c"]:["x","b","r"]}toggleElseIf(){this.ifElseValue=!this.ifElseValue}},de=[function(e){return"Tag test "+e.name+" "+e._name2_Test},function(e){return`
    $notAVar `+e.getName()+" "+e.getName(e.name)+`
    Nested
    `},function(e){return e.url},function(e){return e.empty},function(e){return e.null},function(e){return e.attr},function(e){return expression.bind(e)},function(e){return e.event},function(e){return e.onEvent.bind(e)},function(e){return e.addTodo.bind(e)},function(e){return e.nestedIf},function(e){return e.name},function(e){return e.arr},function(e,n,t){return e.ifElseValue},function(e,n,t){return t},function(e,n,t){return t},function(e,n,t){return t},function(e,n,t){return e.nestedIf},function(e,n,t){return e.name},function(e){return e.arr},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return n+". "},function(e,n,t){return t},function(e,n,t){return t},function(e){return e.arrWithKeys},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return n+": "},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return t},function(e){return e.ifValue},function(e){return e.arrNested},function(e,n,t){return t},function(e,n,t,o,r){return n},function(e,n,t,o,r){return o},function(e,n,t,o,r){return r},function(e,n,t,o,r){return n+". "+o+". "+r},function(e){return e.arrNested},function(e,n,t){return n==="b"},function(e,n,t){return t},function(e,n,t,o,r){return n},function(e,n,t,o,r){return o},function(e,n,t,o,r){return r},function(e,n,t,o,r){return n+". "+o+". "+r},function(e){return e.toggleIf.bind(e)},function(e){return e.toggleElseIf.bind(e)},function(e){return function(n){e.nestedIf=!e.nestedIf}},function(e){return function(n){e.name="Viewi Junior"}},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.arr},function(e,n,t){return t}];var Z=class extends f{_name="TodoApp";text="";items=[];handleSubmit(n){n.preventDefault(),M(this.text)!=0&&(this.items.push(this.text),this.text="")}},pe=[function(e){return function(n){e.handleSubmit(n)}},function(e){return e.text},function(e){return`
        Add #`+(H(e.items)+1)+`
    `},function(e){return e.items}];var ee=class extends f{_name="TodoList";items=null},fe=[function(e){return e.items},function(e,n,t){return t}];var K={CounterReducer:V,TodoReducer:F,MenuBar:U,Counter_x:ue,Counter:W,HomePage_x:se,HomePage:G,Layout_x:ae,Layout:J,NotFoundPage:j,CounterPage:q,TodoAppPage:z,StatefulCounter_x:me,StatefulCounter:Q,StatefulTodoApp_x:le,StatefulTodoApp:X,TestComponent_x:de,TestComponent:Y,TodoApp_x:pe,TodoApp:Z,TodoList_x:fe,TodoList:ee};var Ae=0,he=0,O={};function $(e){return e.__aid||(e.__aid=++Ae,O[e.__aid]={current:-1,target:e,invalid:[],added:0}),O[e.__aid]}function ne(){return++he}function y(e,n=!1,t,o){let r=document.createTextNode("");return r._anchor=o??"#"+ ++he,t&&t.current++,n||t&&e.childNodes.length>t.current?(t?e:e.parentElement).insertBefore(r,t?e.childNodes[t.current]:e):e.appendChild(r),r}function xe(e){let n=new Proxy(e,{set(t,o,r){var c=t[o]!==r,s=Reflect.set(t,o,r);if(c&&o in t.$$r)for(let i in t.$$r[o]){let d=t.$$r[o][i];d[0].apply(null,d[1])}return s}});return e.$=e,n}function be(e,n){let t=$(e),o=e.childNodes.length,r=t.current+3;r=r>o?o:r;let c=[];for(let i=t.current+1;i<r;i++){let d=e.childNodes[i];if(d.nodeType===8)return t.current=i,t.invalid=t.invalid.concat(c),d;c.push(i)}t.added++,t.invalid=t.invalid.concat(c),console.log("Hydrate comment not found",n);let s=document.createComment(n);return t.current=t.current+c.length+1,o>t.current?e.insertBefore(s,e.childNodes[t.current]):e.appendChild(s)}function ve(e,n){let t=$(e),o=e.childNodes.length,r=t.current+3;r=r>o?o:r;let c=[];for(let i=t.current+1;i<r;i++){let d=e.childNodes[i];if(d.nodeType===1&&d.nodeName.toLowerCase()===n)return t.current=i,t.invalid=t.invalid.concat(c),d;c.push(i)}t.added++,t.invalid=t.invalid.concat(c),console.warn("Hydrate not found",n);let s=document.createElement(n);return t.current=t.current+c.length+1,o>t.current?e.insertBefore(s,e.childNodes[t.current]):e.appendChild(s)}function L(e,n,t,o){let r=[e];o&&(r=r.concat(o.arguments));let c=n.expression?e.$$t[n.code].apply(null,r):n.content??"";t.nodeValue!==c&&(t.nodeValue=c)}function ge(e,n,t,o){let r=$(e),c=e.childNodes.length,s=r.current+3;s=s>c?c:s;let i=[],d=r.current>-1?r.current:r.current+1;for(let u=d;u<s;u++){let b=e.childNodes[u];if(b.nodeType===3){if(u===r.current)break;return r.current=u,r.invalid=r.invalid.concat(i),L(n,t,b,o),b}u!==r.current&&i.push(u)}r.added++,r.invalid=r.invalid.concat(i);let T=document.createTextNode("");return L(n,t,T,o),r.current=r.current+i.length+1,c>r.current?e.insertBefore(T,e.childNodes[r.current]):e.appendChild(T)}function oe(e,n,t,o,r){let c=null;if(n.children){c="";for(let s=0;s<n.children.length;s++){let i=n.children[s],d=[e];r&&(d=d.concat(r.arguments));let T=i.expression?e.$$t[i.code].apply(null,d):i.content??"";c=s===0?T:c+(T??"")}}c!==null?c!==t.getAttribute(o)&&t.setAttribute(o,c):t.removeAttribute(o)}function P(e,n){for(let t in e.track){let o=e.track[t];delete n.$$r[o.path][o.id]}if(e.track=[],e.components=[],e.children){for(let t in e.children)P(e.children[t],n);e.children={}}e.parent&&delete e.parent.children[e.id]}function Ce(e,n,t,o,r,c,s){let i=[e];s.arguments&&(i=i.concat(s.arguments));let d=e.$$t[t.children[0].forData].apply(null,i),T=Array.isArray(d),u=o,b=!1,N={},w={};for(let l in d){let a=T?+l:l,v=d[a],x=++s.counter,m={id:x,arguments:[...s.arguments],components:[],map:{...s.map},track:[],parent:s,children:{},counter:0};s.children[x]=m;let p=!1;for(let h in r)if(r[h]===v){p=!0,b=!1,u=o;break}else!b&&!(a in N)&&(u=r[h].begin,b=!0);if(N[a]=!0,!p){m.map[t.children[0].forKey]=m.arguments.length,m.arguments.push(a),m.map[t.children[0].forItem]=m.arguments.length,m.arguments.push(v);let h={map:{...c.map},storage:{...c.storage}},C=y(u,!0,void 0,"b"+ne());B(u,e,[n],m,h,!1,!0);let I=y(u,!0,void 0,C._anchor);a in r&&(w[a]=r[a]),r[a]={key:a,value:v,begin:C,end:I,scope:m}}}for(let l in r)if(!(l in N)){let a=r[l].end;for(;a.previousSibling._anchor!==a._anchor;)a.previousSibling.remove();r[l].begin.remove(),a.remove(),P(r[l].scope,e),delete r[l]}for(let l in w){let a=w[l].end;for(;a.previousSibling._anchor!==a._anchor;)a.previousSibling.remove();w[l].begin.remove(),P(w[l].scope,e),a.remove()}}function te(e,n,t,o,r,c,s,i){let d=!0;for(let u=0;u<i;u++)d=d&&!c.values[u];o.children&&(d=d&&!!e.$$t[o.children[0].code](e));let T={map:{...s.map},storage:{...s.storage}};if(c.values[i]!==d)if(c.values[i]=d,d){let u=++t.parent.counter,b={id:u,arguments:t.parent.arguments,components:t.components,map:t.parent.map,track:t.track,parent:t.parent,children:{},counter:0};t.parent.children[u]=b,B(r,e,[n],b,T,!1,!0)}else for(P(t,e);r.previousSibling._anchor!==r._anchor;)r.previousSibling.remove()}function Te(e,n,t){let o=n.expression?e.$$t[n.code](e):n.content??"";t.nodeValue!==o&&(t.nodeValue=o)}var $e=0;function E(e,n,t,o){e.$$r[n]||(e.$$r[n]={});let r=++$e;t.track.push({id:r,path:n}),e.$$r[n][r]=o}function B(e,n,t,o,r,c=!0,s=!1){let i=null,d=!1;for(let T=0;T<t.length;T++){let u=t[T],b=e,N=!1,w=!1;switch(u.type){case"tag":{if(u.directives){let a=r||{map:{},storage:{}},v=[n];o.arguments&&(v=v.concat(o.arguments));for(let x=0;x<u.directives.length;x++){let m=u.directives[x];if(!(x in a.map)){switch(a.map[x]=!0,m.content){case"if":{i={values:[],index:0,subs:[]};let p=!!n.$$t[m.children[0].code].apply(null,v);i.values.push(p);let h=c?$(e):void 0,C=y(e,s,h),I={map:{...a.map},storage:{...a.storage}},A=++o.counter,_={id:A,arguments:o.arguments,components:[],map:o.map,track:[],parent:o,children:{},counter:0};o.children[A]=_,p&&B(e,n,[u],_,a,c,s);let S=y(e,s,h,C._anchor);if(m.children[0].subs)for(let g in m.children[0].subs){let k=m.children[0].subs[g];i.subs.push(k),E(n,k,o,[te,[n,u,_,m,S,i,I,i.index]])}i.index++,N=!0;break}case"else-if":{if(i){let p=!0;for(let g=0;g<i.index;g++)p=p&&!i.values[g];p=p&&!i.values[i.index-1]&&!!n.$$t[m.children[0].code].apply(null,v),i.values.push(p);let h=c?$(e):void 0,C=y(e,s,h),I={map:{...a.map},storage:{...a.storage}},A=++o.counter,_={id:A,arguments:o.arguments,components:[],map:o.map,track:[],parent:o,children:{},counter:0};o.children[A]=_,p&&B(e,n,[u],_,a,c,s);let S=y(e,s,h,C._anchor);m.children[0].subs&&(i.subs=i.subs.concat(m.children[0].subs));for(let g in i.subs){let k=i.subs[g];E(n,k,o,[te,[n,u,_,m,S,i,I,i.index]])}i.index++,N=!0}else console.warn("Directive else-if has missing previous if/else-if",m.content,m);break}case"else":{if(i){let p=!0;for(let g=0;g<i.index;g++)p=p&&!i.values[g];i.values.push(p);let h=c?$(e):void 0,C=y(e,s,h),I={map:{...a.map},storage:{...a.storage}},A=++o.counter,_={id:A,arguments:o.arguments,components:[],map:o.map,track:[],parent:o,children:{},counter:0};o.children[A]=_,p&&B(e,n,[u],_,a,c,s);let S=y(e,s,h,C._anchor);for(let g in i.subs){let k=i.subs[g];E(n,k,o,[te,[n,u,_,m,S,i,I,i.index]])}i.index++,N=!0}else console.warn("Directive else has missing previous if/else-if",m.content,m);break}case"foreach":{let p=n.$$t[m.children[0].forData].apply(null,v),h=c?$(e):void 0,C=y(e,s,h),I=Array.isArray(p),A={};for(let S in p){let g=I?+S:S,k=p[g],ie=++o.counter,D={id:ie,arguments:[...o.arguments],components:[],map:{...o.map},track:[],parent:o,children:{},counter:0};o.children[ie]=D,D.map[m.children[0].forKey]=D.arguments.length,D.arguments.push(g),D.map[m.children[0].forItem]=D.arguments.length,D.arguments.push(k);let _e={map:{...a.map},storage:{...a.storage}},ce=y(e,s,h,"b"+ne());B(e,n,[u],D,_e,c,s);let Ne=y(e,s,h,ce._anchor);A[g]={key:g,value:k,begin:ce,end:Ne,scope:D}}let _=y(e,s,h,C._anchor);if(m.children[0].subs)for(let S in m.children[0].subs){let g=m.children[0].subs[S],k={map:{...a.map},storage:{...a.storage}};E(n,g,o,[Ce,[n,u,m,_,A,k,o]])}N=!0;break}default:{console.warn("Directive not implemented",m.content,m),N=!0;break}}if(N)break}}if(N)continue}if(u.content==="template"){d=s;break}w=!0;let l=u.expression?n.$$t[u.code](n):u.content??"";b=c?ve(e,l):s?e.parentElement.insertBefore(document.createElement(l),e):e.appendChild(document.createElement(l));break}case"text":{let l;if(c?l=ge(e,n,u,o):(l=document.createTextNode(""),L(n,u,l,o),s?e.parentElement.insertBefore(l,e):e.appendChild(l)),u.subs)for(let a in u.subs){let v=u.subs[a];E(n,v,o,[L,[n,u,l,o]])}break}case"comment":{let l=u.expression?n.$$t[u.code](n):u.content??"",a=c?be(e,l):s?e.parentElement.insertBefore(document.createComment(l),e):e.appendChild(document.createComment(l));if(u.subs)for(let v in u.subs){let x=u.subs[v];E(n,x,o,[Te,[n,u,a]])}break}default:{console.warn("Node type not implemented",u);break}}if(w){if(u.attributes){let l=c?b.getAttributeNames():null,a=c?{}:null;for(let v in u.attributes){let x=u.attributes[v],m=x.expression?n.$$t[x.code](n):x.content??"";if(m[0]==="("){let p=m.substring(1,m.length-1);if(x.children){let h=n.$$t[x.dynamic?x.dynamic.code:x.children[0].code](n);b.addEventListener(p,h)}}else{c&&(a[m]=!0),oe(n,x,b,m,o);let p=[];if(x.children)for(let h in x.children){let C=x.children[h];C.subs&&(p=p.concat(C.subs))}if(p)for(let h in p){let C=p[h];E(n,C,o,[oe,[n,x,b,m,o]])}}}if(c)for(let v=0;v<l.length;v++)l[v]in a||b.removeAttribute(l[v])}else if(c){let l=b.getAttributeNames();for(let a=0;a<l.length;a++)b.removeAttribute(l[a])}}u.children&&B(b,n,u.children,o,void 0,c,d)}}function R(e){let n="value";switch(e.t){case"t":{n="tag";break}case"a":{n="attr";break}case void 0:case"v":{n="value";break}case"c":{n="component";break}case"x":{n="text";break}case"m":{n="comment";break}case"r":{n="root";break}default:throw new Error("Type "+e.t+" is not defined in build")}if(e.type=n,delete e.t,e.c&&(e.content=e.c,delete e.c),e.e&&(e.expression=e.e,delete e.e),e.a){e.attributes=e.a,delete e.a;for(let t in e.attributes)R(e.attributes[t])}if(e.i){e.directives=e.i,delete e.i;for(let t in e.directives)R(e.directives[t])}if(e.h){e.children=e.h,delete e.h;for(let t in e.children)R(e.children[t])}}var re={},Be=()=>({version:"2.0.1"});globalThis.Viewi=Be;console.log("Viewi entry");var ye=document.getElementById("counter");function Se(e){if(!(e in re))throw new Error(`Component ${e} not found.`);if(!(e in K))throw new Error(`Component ${e} not found.`);let n=re[e].nodes,t=xe(new K[e]),o=e+"_x";if(o in K&&(t.$$t=K[o]),ye&&n){n.unpacked||(R(n),n.unpacked=!0);let r=n.children;r&&B(ye,t,r,{id:0,arguments:[],components:[],map:{},track:[],children:{},counter:0})}for(let r in O){let c=O[r];for(let s=c.target.childNodes.length-1;s>=c.current+1;s--)c.target.childNodes[s].remove();for(let s=c.invalid.length-1;s>=0;s--)c.target.childNodes[c.invalid[s]].remove()}}(async()=>(re=await(await fetch("/assets/components.json")).json(),setTimeout(()=>Se("TestComponent"),500)))();})();
