(()=>{var _=class{count=0;increment(){this.count++}decrement(){this.count--}};var V=class{items=[];addNewItem(t){this.items.push(t)}};var d=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(t,o){this.$_callbacks&&t in this.$_callbacks&&this.$_callbacks[t](o)}};var I=class extends d{_name="MenuBar"};function N(e){var t=e+"";return t.length}var P=class extends d{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},J=[function(e){return function(t){e.decrement()}},function(e){return e.count%10+12},function(e){return`
    Count `+e.count+" "+N(e.message)+`
`},function(e){return`
Count `+e.count+" "+N(e.message)+`
`},function(e){return function(t){e.increment()}},function(e){return function(t){e.increment(t)}},function(e){return e.increment.bind(e)},function(e){return e.message}];var S=class extends d{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},Q=[function(e){return e.title},function(e){return e.title}];var L=class extends d{_name="Layout";title="Viewi"},X=[function(e){return`
        `+e.title+` | Viewi
    `}];var M=class extends d{_name="NotFoundPage"};var H=class extends d{_name="CounterPage"};var O=class extends d{_name="TodoAppPage"};var F=class extends d{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(t){super(),this.count=t===void 0?0:t,this.counter=new _}$calculate(){this.count++}},Y=[function(e){return function(t){e.counter.decrement()}},function(e){return e.__id},function(e){return e.counter.count},function(e){return function(t){e.counter.increment()}}];function w(e,t){let o,r=0;if(e===null||typeof e>"u")return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;t==="COUNT_RECURSIVE"&&(t=1),t!==1&&(t=0);for(o in e)e.hasOwnProperty(o)&&(r++,t===1&&e[o]&&(e[o].constructor===Array||e[o].constructor===Object)&&(r+=w(e[o],1)));return r}var R=class extends d{_name="StatefulTodoApp";text="";todo=null;constructor(t){super(),this.todo=t}handleSubmit(t){t.preventDefault(),N(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},Z=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return`
        Add #`+(w(e.todo.items)+1)+`
    `},function(e){return e.todo.items}];var U=class extends d{_name="TestComponent";name="MyName";_name2_Test="MyName_2";empty="";null=null;url="/home";attr="title";event="(click)";arr=["a","b","c"];arrWithKeys={a:"Apple",b:"Orange",c:"Lemon"};arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},b:{a:"Apple",b:"Orange",c:"Lemon"},c:{a:"Apple",b:"Orange",c:"Lemon"}};ifValue=!1;ifElseValue=!0;getName(t){var o=60;return t??"DefaultName"}onEvent(t){t.preventDefault()}toggleIf(){this.ifValue=!this.ifValue}toggleElseIf(){this.ifElseValue=!this.ifElseValue}},ee=[function(e){return"Tag test "+e.name+" "+e._name2_Test},function(e){return`
    $notAVar `+e.getName()+" "+e.getName(e.name)+`
    Nested
    `},function(e){return e.url},function(e){return e.empty},function(e){return e.null},function(e){return e.attr},function(e){return e.expression.bind(e)},function(e){return e.event},function(e){return e.onEvent.bind(e)},function(e){return e.toggleIf.bind(e)},function(e){return e.toggleElseIf.bind(e)},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.ifValue},function(e){return e.ifElseValue}];var K=class extends d{_name="TodoApp";text="";items=[];handleSubmit(t){t.preventDefault(),N(this.text)!=0&&(this.items.push(this.text),this.text="")}},te=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return`
        Add #`+(w(e.items)+1)+`
    `},function(e){return e.items}];var W=class extends d{_name="TodoList";items=null},oe=[function(e){return e.item}];var E={CounterReducer:_,TodoReducer:V,MenuBar:I,Counter_x:J,Counter:P,HomePage_x:Q,HomePage:S,Layout_x:X,Layout:L,NotFoundPage:M,CounterPage:H,TodoAppPage:O,StatefulCounter_x:Y,StatefulCounter:F,StatefulTodoApp_x:Z,StatefulTodoApp:R,TestComponent_x:ee,TestComponent:U,TodoApp_x:te,TodoApp:K,TodoList_x:oe,TodoList:W};var ue=0,g={};function T(e){return e.__aid||(e.__aid=++ue,g[e.__aid]={current:-1,target:e,invalid:[],added:0}),g[e.__aid]}function y(e,t){let o=document.createTextNode("");return o._anchor=!0,e.current++,t.childNodes.length>e.current?t.insertBefore(o,t.childNodes[e.current]):t.appendChild(o),o}function ne(e){let t=new Proxy(e,{set(o,r,s){var c=o[r]!==s,n=Reflect.set(o,r,s);if(c&&r in o.$$r)for(let l in o.$$r[r]){let m=o.$$r[r][l];m[0].apply(null,m[1])}return n}});return e.$=e,t}function re(e,t){let o=T(e),r=e.childNodes.length,s=o.current+3;s=s>r?r:s;let c=[];for(let l=o.current+1;l<s;l++){let m=e.childNodes[l];if(m.nodeType===8)return o.current=l,o.invalid=o.invalid.concat(c),m;c.push(l)}o.added++,console.log("Hydrate comment not found",t);let n=document.createComment(t);return o.current++,r>o.current?e.insertBefore(n,e.childNodes[o.current]):e.appendChild(n)}function ie(e,t){let o=T(e),r=e.childNodes.length,s=o.current+3;s=s>r?r:s;let c=[];for(let l=o.current+1;l<s;l++){let m=e.childNodes[l];if(m.nodeType===1&&m.nodeName.toLowerCase()===t)return o.current=l,o.invalid=o.invalid.concat(c),m;c.push(l)}o.added++,console.log("Hydrate not found",t);let n=document.createElement(t);return o.current++,r>o.current?e.insertBefore(n,e.childNodes[o.current]):e.appendChild(n)}function k(e,t,o){let r=t.expression?e.$$t[t.code](e):t.content??"";o.nodeValue!==r&&(o.nodeValue=r)}function se(e,t,o){let r=T(e),s=e.childNodes.length,c=r.current+3;c=c>s?s:c;let n=[],l=r.current>-1?r.current:r.current+1;for(let i=l;i<c;i++){let $=e.childNodes[i];if($.nodeType===3){if(i===r.current)break;return r.current=i,r.invalid=r.invalid.concat(n),k(t,o,$),$}i!==r.current&&n.push(i)}r.added++;let m=document.createTextNode("");return k(t,o,m),r.current++,console.log("Hydrate not found",m),s>r.current?e.insertBefore(m,e.childNodes[r.current]):e.appendChild(m)}function q(e,t,o,r){let s=null;if(t.children){s="";for(let c=0;c<t.children.length;c++){let n=t.children[c],l=n.expression?e.$$t[n.code](e):n.content??"";s=c===0?l:s+(l??"")}}s!==null?s!==o.getAttribute(r)&&o.setAttribute(r,s):o.removeAttribute(r)}function j(e,t,o,r,s,c,n){let l=!0;for(let m=0;m<n;m++)l=l&&!s.values[m];if(o.children&&(l=l&&!!e.$$t[o.children[0].code](e)),s.values[n]!==l)if(s.values[n]=l,l)C(r,e,[t],{...c},!1,!0);else for(;!r.previousSibling._anchor;)r.previousSibling.remove()}function ce(e,t,o){let r=t.expression?e.$$t[t.code](e):t.content??"";o.nodeValue!==r&&(o.nodeValue=r)}function C(e,t,o,r,s=!0,c=!1){let n=null,l=!1;for(let m=0;m<o.length;m++){let i=o[m],$=e,A=!1;switch(i.type){case"tag":{if(i.directives){let a=r||{map:{},storage:{}};for(let p=0;p<i.directives.length;p++){let u=i.directives[p];if(!(p in a.map)){switch(a.map[p]=!0,u.content){case"if":{n={values:[],index:0,subs:[]};let f=!!t.$$t[u.children[0].code](t);n.values.push(f);let x=T(e);y(x,e),f&&C(e,t,[i],a);let B=y(x,e);if(u.children[0].subs)for(let b in u.children[0].subs){let v=u.children[0].subs[b];n.subs.push(v),t.$$r[v]||(t.$$r[v]=[]),t.$$r[v].push([j,[t,i,u,B,n,{...a},n.index]])}n.index++,A=!0;break}case"else-if":{if(n){let f=!0;for(let b=0;b<n.index;b++)f=f&&!n.values[b];f=f&&!n.values[n.index-1]&&!!t.$$t[u.children[0].code](t),n.values.push(f);let x=T(e);y(x,e),f&&C(e,t,[i],a);let B=y(x,e);u.children[0].subs&&(n.subs=n.subs.concat(u.children[0].subs));for(let b in n.subs){let v=n.subs[b];t.$$r[v]||(t.$$r[v]=[]),t.$$r[v].push([j,[t,i,u,B,n,{...a},n.index]])}n.index++,A=!0}else console.warn("Directive else-if has missing previous if/else-if",u.content,u);break}case"else":{if(n){let f=!0;for(let b=0;b<n.index;b++)f=f&&!n.values[b];n.values.push(f);let x=T(e);y(x,e),f&&C(e,t,[i],a);let B=y(x,e);for(let b in n.subs){let v=n.subs[b];t.$$r[v]||(t.$$r[v]=[]),t.$$r[v].push([j,[t,i,u,B,n,{...a},n.index]])}n.index++,A=!0}else console.warn("Directive else has missing previous if/else-if",u.content,u);break}default:{console.warn("Directive not implemented",u.content,u);break}}if(A)break}}if(A)continue}if(i.content==="template"){l=c;break}let h=i.expression?t.$$t[i.code](t):i.content??"";$=s?ie(e,h):c?e.parentElement.insertBefore(document.createElement(h),e):e.appendChild(document.createElement(h));break}case"text":{let h;if(s?h=se(e,t,i):(h=document.createTextNode(""),k(t,i,h),c?e.parentElement.insertBefore(h,e):e.appendChild(h)),i.subs)for(let a in i.subs){let p=i.subs[a];t.$$r[p]||(t.$$r[p]=[]),t.$$r[p].push([k,[t,i,h]])}break}case"comment":{let h=i.expression?t.$$t[i.code](t):i.content??"",a=s?re(e,h):c?e.parentElement.insertBefore(document.createComment(h),e):e.appendChild(document.createComment(h));if(i.subs)for(let p in i.subs){let u=i.subs[p];t.$$r[u]||(t.$$r[u]=[]),t.$$r[u].push([ce,[t,i,a]])}break}default:{console.log("Not implemented",i);break}}if(i.attributes)for(let h in i.attributes){let a=i.attributes[h],p=a.expression?t.$$t[a.code](t):a.content??"";if(p[0]==="("){let u=p.substring(1,p.length-1);if(a.children){let f=t.$$t[a.dynamic?a.dynamic.code:a.children[0].code](t);$.addEventListener(u,f),console.log("Event",a,u,f)}}else{q(t,a,$,p);let u=[];if(a.children)for(let f in a.children){let x=a.children[f];x.subs&&(u=u.concat(x.subs))}if(u)for(let f in u){let x=u[f];t.$$r[x]||(t.$$r[x]=[]),t.$$r[x].push([q,[t,a,$,p]])}}}i.children&&C($,t,i.children,void 0,s,l)}}function D(e){let t="value";switch(e.t){case"t":{t="tag";break}case"a":{t="attr";break}case void 0:case"v":{t="value";break}case"c":{t="component";break}case"x":{t="text";break}case"m":{t="comment";break}case"r":{t="root";break}default:throw new Error("Type "+e.t+" is not defined in build")}if(e.type=t,delete e.t,e.c&&(e.content=e.c,delete e.c),e.e&&(e.expression=e.e,delete e.e),e.a){e.attributes=e.a,delete e.a;for(let o in e.attributes)D(e.attributes[o])}if(e.i){e.directives=e.i,delete e.i;for(let o in e.directives)D(e.directives[o])}if(e.h){e.children=e.h,delete e.h;for(let o in e.children)D(e.children[o])}}var G={},le=()=>({version:"2.0.1"});globalThis.Viewi=le;console.log("Viewi entry");var z=document.getElementById("counter");function ae(e){if(!(e in G))throw new Error(`Component ${e} not found.`);if(!(e in E))throw new Error(`Component ${e} not found.`);let t=G[e].nodes,o=ne(new E[e]),r=e+"_x";if(r in E&&(o.$$t=E[r]),z&&t){t.unpacked||(D(t),t.unpacked=!0);let s=t.children;console.log(z,o,s),s&&C(z,o,s)}console.log(g);for(let s in g){let c=g[s];for(let n=c.invalid.length-1;n>=0;n--)c.target.childNodes[c.invalid[n]].remove();for(let n=c.current+1;n<c.target.childNodes.length;n++)c.target.childNodes[n].remove()}}(async()=>(G=await(await fetch("/assets/components.json")).json(),setTimeout(()=>ae("TestComponent"),500)))();})();
