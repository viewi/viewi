(()=>{var f=class{count=0;increment(){this.count++}decrement(){this.count--}};var b=class{items=[];addNewItem(t){this.items.push(t)}};var c=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(t,n){this.$_callbacks&&t in this.$_callbacks&&this.$_callbacks[t](n)}};var _=class extends c{_name="MenuBar"};function h(e){var t=e+"";return t.length}var $=class extends c{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},S=[function(e){return function(t){e.decrement()}},function(e){return e.count%10+12},function(e){return e.count},function(e){return h(e.message)},function(e){return function(t){e.increment()}},function(e){return function(t){e.increment(t)}},function(e){return e.increment.bind(e)},function(e){return e.message}];var C=class extends c{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},I=[function(e){return e.title},function(e){return e.title}];var g=class extends c{_name="Layout";title="Viewi"},F=[function(e){return e.title}];var v=class extends c{_name="NotFoundPage"};var N=class extends c{_name="CounterPage"};var k=class extends c{_name="TodoAppPage"};var w=class extends c{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(t){super(),this.count=t===void 0?0:t,this.counter=new f}$calculate(){this.count++}},R=[function(e){return function(t){e.counter.decrement()}},function(e){return e.__id},function(e){return e.counter.count},function(e){return function(t){e.counter.increment()}}];function x(e,t){let n,r=0;if(e===null||typeof e>"u")return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;t==="COUNT_RECURSIVE"&&(t=1),t!==1&&(t=0);for(n in e)e.hasOwnProperty(n)&&(r++,t===1&&e[n]&&(e[n].constructor===Array||e[n].constructor===Object)&&(r+=x(e[n],1)));return r}var E=class extends c{_name="StatefulTodoApp";text="";todo=null;constructor(t){super(),this.todo=t}handleSubmit(t){t.preventDefault(),h(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},O=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return x(e.todo.items)+1},function(e){return e.todo.items}];var B=class extends c{_name="TodoApp";text="";items=[];handleSubmit(t){t.preventDefault(),h(this.text)!=0&&(this.items.push(this.text),this.text="")}},D=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return x(e.items)+1},function(e){return e.items}];var H=class extends c{_name="TodoList";items=null},U=[function(e){return e.item}];var T={CounterReducer:f,TodoReducer:b,MenuBar:_,Counter_x:S,Counter:$,HomePage_x:I,HomePage:C,Layout_x:F,Layout:g,NotFoundPage:v,CounterPage:N,TodoAppPage:k,StatefulCounter_x:R,StatefulCounter:w,StatefulTodoApp_x:O,StatefulTodoApp:E,TodoApp_x:D,TodoApp:B,TodoList_x:U,TodoList:H};function V(e){let t=new Proxy(e,{set(n,r,o){var s=n[r]!==o,i=Reflect.set(n,r,o);if(s&&r in n.$$r)for(let l in n.$$r[r]){let u=n.$$r[r][l];u[0].apply(null,u[1])}return i}});return e.$=e,t}function L(e){let t="value";switch(e.t){case"t":{t="tag";break}case"a":{t="attr";break}case void 0:case"v":{t="value";break}case"c":{t="component";break}case"x":{t="text";break}case"m":{t="comment";break}case"r":{t="root";break}default:throw new Error("Type "+e.t+" is not defined in build")}if(e.type=t,delete e.t,e.c&&(e.content=e.c,delete e.c),e.e&&(e.expression=e.e,delete e.e),e.a){e.attributes=e.a,delete e.a;for(let n in e.attributes)L(e.attributes[n])}if(e.h){e.children=e.h,delete e.h;for(let n in e.children)L(e.children[n])}}var P={},G=()=>({version:"2.0.1"});globalThis.Viewi=G;console.log("Viewi entry");var M=document.getElementById("counter");function j(e,t,n,r){let o=null;if(t.children){o="";for(let s in t.children){let i=t.children[s];o+=(i.expression?e.$$t[i.code](e):i.content)??""}}o!==null&&n.setAttribute(r,o)}function A(e,t,n){let r=t.expression?e.$$t[t.code](e):t.content??"";n.nodeValue!==r&&(n.nodeValue=r)}var J=0,y={};function q(e){return e.__aid||(e.__aid=++J,y[e.__aid]={current:-1,target:e,invalid:[],added:0}),y[e.__aid]}function K(e,t){let n=q(e),r=e.childNodes.length,o=n.current+3;o=o>r?r:o;let s=[];for(let i=n.current+1;i<o;i++){let l=e.childNodes[i];if(l.nodeType===1&&l.nodeName.toLowerCase()===t)return n.current=i,n.invalid=n.invalid.concat(s),console.log("Hydrate match",l),l;s.push(i)}return n.added++,console.log("Hydrate not found",t),e.appendChild(document.createElement(t))}function Q(e,t,n){let r=q(e),o=e.childNodes.length-r.added,s=r.current+3;s=s>o?o:s;let i=[];for(let u=r.current+1;u<s;u++){let a=e.childNodes[u];if(a.nodeType===3)return r.current=u,r.invalid=r.invalid.concat(i),A(t,n,a),console.log("Hydrate match",a),a;i.push(u)}r.added++;let l=document.createTextNode("");return A(t,n,l),console.log("Hydrate not found",l),e.appendChild(l)}function z(e,t,n){for(let r in n){let o=n[r],s=e,i=!0;switch(o.type){case"tag":{let l=o.expression?t.$$t[o.code](t):o.content??"";s=i?K(e,l):e.appendChild(document.createElement(l));break}case"text":{let l;if(i?l=Q(e,t,o):(l=document.createTextNode(""),A(t,o,l),e.appendChild(l)),o.subs)for(let u in o.subs){let a=o.subs[u];t.$$r[a]||(t.$$r[a]=[]),t.$$r[a].push([A,[t,o,l]])}break}default:{console.log("No implemented",o);break}}if(o.attributes)for(let l in o.attributes){let u=o.attributes[l],a=u.expression?t.$$t[u.code](t):u.content??"";if(a[0]==="("){let d=a.substring(1,a.length-1);if(u.children){let m=t.$$t[u.children[0].code](t);s.addEventListener(d,m),console.log("Event",u,d,m)}}else{j(t,u,s,a);let d=[];if(u.children)for(let m in u.children){let p=u.children[m];p.subs&&(d=d.concat(p.subs))}if(d)for(let m in d){let p=d[m];t.$$r[p]||(t.$$r[p]=[]),t.$$r[p].push([j,[t,u,s,a]])}}}o.children&&z(s,t,o.children)}}function W(e){if(!(e in P))throw new Error(`Component ${e} not found.`);if(!(e in T))throw new Error(`Component ${e} not found.`);let t=P[e].nodes,n=V(new T[e]),r=e+"_x";if(r in T&&(n.$$t=T[r]),M&&t){t.unpacked||(L(t),t.unpacked=!0);let o=t.children;console.log(M,n,o),o&&z(M,n,o)}console.log(y);for(let o in y){let s=y[o];for(let i=s.invalid.length-1;i>=0;i--)s.target.childNodes[s.invalid[i]].remove();for(let i=s.current+1;i<s.target.childNodes.length-s.added;i++)s.target.childNodes[i].remove()}}(async()=>(P=await(await fetch("/assets/components.json")).json(),W("Counter")))();})();
