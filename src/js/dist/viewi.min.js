(()=>{var d=class{count=0;increment(){this.count++}decrement(){this.count--}};var $=class{items=[];addNewItem(e){this.items.push(e)}};var r=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(e,n){this.$_callbacks&&e in this.$_callbacks&&this.$_callbacks[e](n)}};var T=class extends r{_name="MenuBar"};function x(t){var e=t+"";return e.length}var y=class extends r{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},A=[function(t){return function(e){t.decrement()}},function(t){return t.message},function(t){return t.count%10+12},function(t){return t.count},function(t){return x(t.message)},function(t){return function(e){t.increment()}},function(t){return function(e){t.increment(e)}},function(t){return t.increment.bind(t)}];var C=class extends r{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},H=[function(t){return t.title},function(t){return t.title}];var g=class extends r{_name="Layout";title="Viewi"},M=[function(t){return t.title}];var _=class extends r{_name="NotFoundPage"};var k=class extends r{_name="CounterPage"};var v=class extends r{_name="TodoAppPage"};var w=class extends r{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(e){super(),this.count=e===void 0?0:e,this.counter=new d}$calculate(){this.count++}},I=[function(t){return function(e){t.counter.decrement()}},function(t){return t.__id},function(t){return t.counter.count},function(t){return function(e){t.counter.increment()}}];function h(t,e){let n,s=0;if(t===null||typeof t>"u")return 0;if(t.constructor!==Array&&t.constructor!==Object)return 1;e==="COUNT_RECURSIVE"&&(e=1),e!==1&&(e=0);for(n in t)t.hasOwnProperty(n)&&(s++,e===1&&t[n]&&(t[n].constructor===Array||t[n].constructor===Object)&&(s+=h(t[n],1)));return s}var B=class extends r{_name="StatefulTodoApp";text="";todo=null;constructor(e){super(),this.todo=e}handleSubmit(e){e.preventDefault(),x(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},F=[function(t){return function(e){t.handleSubmit(e)}},function(t){return t.text},function(t){return h(t.todo.items)+1},function(t){return t.todo.items}];var N=class extends r{_name="TodoApp";text="";items=[];handleSubmit(e){e.preventDefault(),x(this.text)!=0&&(this.items.push(this.text),this.text="")}},R=[function(t){return function(e){t.handleSubmit(e)}},function(t){return t.text},function(t){return h(t.items)+1},function(t){return t.items}];var E=class extends r{_name="TodoList";items=null},O=[function(t){return t.item}];var b={CounterReducer:d,TodoReducer:$,MenuBar:T,Counter_x:A,Counter:y,HomePage_x:H,HomePage:C,Layout_x:M,Layout:g,NotFoundPage:_,CounterPage:k,TodoAppPage:v,StatefulCounter_x:I,StatefulCounter:w,StatefulTodoApp_x:F,StatefulTodoApp:B,TodoApp_x:R,TodoApp:N,TodoList_x:O,TodoList:E};function D(t){let e=new Proxy(t,{set(n,s,o){var c=n[s]!==o,a=Reflect.set(n,s,o);if(c&&s in n.$$r)for(let p in n.$$r[s]){let i=n.$$r[s][p];i[0].apply(null,i[1])}return a}});return t.$=t,e}function P(t){let e="value";switch(t.t){case"t":{e="tag";break}case"a":{e="attr";break}case void 0:case"v":{e="value";break}case"c":{e="component";break}case"x":{e="text";break}case"m":{e="comment";break}case"r":{e="root";break}default:throw new Error("Type "+t.t+" is not defined in build")}if(t.type=e,delete t.t,t.c&&(t.content=t.c,delete t.c),t.e&&(t.expression=t.e,delete t.e),t.a){t.attributes=t.a,delete t.a;for(let n in t.attributes)P(t.attributes[n])}if(t.h){t.children=t.h,delete t.h;for(let n in t.children)P(t.children[n])}}var S={},q=()=>({version:"2.0.1"});globalThis.Viewi=q;console.log("Viewi entry");var L=document.getElementById("counter");function U(t,e,n,s){let o=null;if(e.children){o="";for(let c in e.children){let a=e.children[c];o+=(a.expression?t.$$t[a.code](t):a.content)??""}}o!==null&&n.setAttribute(s,o)}function V(t,e,n){let s=e.expression?t.$$t[e.code](t):e.content??"";n.nodeValue=s}function j(t,e,n){for(let s in n){let o=n[s],c=t,a=o.expression?e.$$t[o.code](e):o.content??"";switch(o.type){case"tag":{c=document.createElement(a),t.appendChild(c),console.log("tag",o);break}case"text":{let p=document.createTextNode(a);if(t.appendChild(p),V(e,o,p),o.subs)for(let i in o.subs){let u=o.subs[i];e.$$r[u]||(e.$$r[u]=[]),e.$$r[u].push([V,[e,o,p]])}break}default:{console.log("No implemented",o);break}}if(o.attributes)for(let p in o.attributes){let i=o.attributes[p],u=i.expression?e.$$t[i.code](e):i.content??"";if(u[0]==="("){let l=u.substring(1,u.length-1);if(i.children){let m=e.$$t[i.children[0].code](e);c.addEventListener(l,m),console.log("Event",i,l,m)}}else{U(e,i,c,u);let l=[];if(i.children)for(let m in i.children){let f=i.children[m];f.subs&&(l=l.concat(f.subs))}if(l)for(let m in l){let f=l[m];e.$$r[f]||(e.$$r[f]=[]),e.$$r[f].push([U,[e,i,c,u]])}}}o.children&&j(c,e,o.children)}}function z(t){if(!(t in S))throw new Error(`Component ${t} not found.`);if(!(t in b))throw new Error(`Component ${t} not found.`);let e=S[t].nodes,n=D(new b[t]),s=t+"_x";if(s in b&&(n.$$t=b[s]),L&&e){e.unpacked||(P(e),e.unpacked=!0);let o=e.children;console.log(L,n,o),o&&j(L,n,o)}}(async()=>(S=await(await fetch("/assets/components.json")).json(),z("Counter")))();})();
