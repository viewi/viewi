(()=>{var Be=0,ae=0,K={};function $(e){return e.__aid||(e.__aid=++Be,K[e.__aid]={current:-1,target:e,invalid:[],added:0}),K[e.__aid]}function U(){return++ae}function y(e,n=!1,t,o){let r=document.createTextNode("");return r._anchor=o??"#"+ ++ae,t&&t.current++,n||t&&e.childNodes.length>t.current?(t?e:e.parentElement).insertBefore(r,t?e.childNodes[t.current]:e):e.appendChild(r),r}var $e={list:{}},O=$e;var L=class{count=0;increment(){this.count++}decrement(){this.count--}};var W=class{items=[];addNewItem(n){this.items.push(n)}};var f=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(n,t){this.$_callbacks&&n in this.$_callbacks&&this.$_callbacks[n](t)}};var G=class extends f{_name="MenuBar"};function M(e){var n=e+"";return n.length}var J=class extends f{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},le=[function(e){return function(n){e.decrement()}},function(e){return e.count%10+12},function(e){return`
    Count `+e.count+" "+M(e.message)+`
`},function(e){return`
Count `+e.count+" "+M(e.message)+`
`},function(e){return function(n){e.increment()}},function(e){return function(n){e.increment(n)}},function(e){return e.increment.bind(e)},function(e){return e.message}];var j=class extends f{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},de=[function(e){return e.title},function(e){return e.title}];var q=class extends f{_name="Layout";title="Viewi"},pe=[function(e){return`
        `+e.title+` | Viewi
    `}];var z=class extends f{_name="NotFoundPage"};var Q=class extends f{_name="CounterPage"};var X=class extends f{_name="TodoAppPage"};var Y=class extends f{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(n){super(),this.count=n===void 0?0:n,this.counter=new L}$calculate(){this.count++}},fe=[function(e){return function(n){e.counter.decrement()}},function(e){return e.__id},function(e){return e.counter.count},function(e){return function(n){e.counter.increment()}}];function R(e,n){let t,o=0;if(e===null||typeof e>"u")return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;n==="COUNT_RECURSIVE"&&(n=1),n!==1&&(n=0);for(t in e)e.hasOwnProperty(t)&&(o++,n===1&&e[t]&&(e[t].constructor===Array||e[t].constructor===Object)&&(o+=R(e[t],1)));return o}var Z=class extends f{_name="StatefulTodoApp";text="";todo=null;constructor(n){super(),this.todo=n}handleSubmit(n){n.preventDefault(),M(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},he=[function(e){return function(n){e.handleSubmit(n)}},function(e){return e.text},function(e){return`
        Add #`+(R(e.todo.items)+1)+`
    `},function(e){return e.todo.items}];var ee=class extends f{_name="ItemComponent"};var ne=class extends f{_name="SomeComponent"};var te=class extends f{_name="TestComponent";name="MyName";_name2_Test="MyName_2";empty="";null=null;url="/home";attr="title";event="(click)";arr=["a","b","c"];arrWithKeys={a:"Apple",b:"Orange",c:"Lemon"};arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},b:{a:"Apple",b:"Orange",c:"Lemon"},c:{a:"Apple",b:"Orange",c:"Lemon"}};ifValue=!0;ifElseValue=!0;nestedIf=!0;getName(n){var t=60;return n??"DefaultName"}addTodo(){this.arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},d:{R:"Rat",T:"Dog",G:"Cat"},b:{a:"Apple",b:"Orange",c:"Lemon"}}}onEvent(n){n.preventDefault()}toggleIf(){this.ifValue=!this.ifValue,this.arr=this.ifValue?["a","b","c"]:["x","b","r"]}toggleElseIf(){this.ifElseValue=!this.ifElseValue}},xe=[function(e){return"Tag test "+e.name+" "+e._name2_Test},function(e){return`
    $notAVar `+e.getName()+" "+e.getName(e.name)+`
    Nested
    `},function(e){return e.url},function(e){return e.empty},function(e){return e.null},function(e){return e.attr},function(e){return expression.bind(e)},function(e){return e.event},function(e){return e.onEvent.bind(e)},function(e){return"custom "+e.name+" slot"},function(e){return"Custom "+e.name+" Slot"},function(e){return"Custom "+e.name+` slot
        `},function(e){return"Custom header "+e.name+" inside div"},function(e){return"Custom "+e.name+" footer"},function(e){return e.addTodo.bind(e)},function(e){return e.nestedIf},function(e){return e.name},function(e){return e.arr},function(e,n,t){return e.ifElseValue},function(e,n,t){return t},function(e,n,t){return t},function(e,n,t){return t},function(e,n,t){return e.nestedIf},function(e,n,t){return e.name},function(e){return e.arr},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return n+". "},function(e,n,t){return t},function(e,n,t){return t},function(e){return e.arrWithKeys},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return n+": "},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return t},function(e){return e.ifValue},function(e){return e.arrNested},function(e,n,t){return t},function(e,n,t,o,r){return n},function(e,n,t,o,r){return o},function(e,n,t,o,r){return r},function(e,n,t,o,r){return n+". "+o+". "+r},function(e){return e.arrNested},function(e,n,t){return n==="b"},function(e,n,t){return t},function(e,n,t,o,r){return n},function(e,n,t,o,r){return o},function(e,n,t,o,r){return r},function(e,n,t,o,r){return n+". "+o+". "+r},function(e){return e.toggleIf.bind(e)},function(e){return e.toggleElseIf.bind(e)},function(e){return function(n){e.nestedIf=!e.nestedIf}},function(e){return function(n){e.name="Viewi Junior"}},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.arr},function(e,n,t){return t}];var oe=class extends f{_name="TodoApp";text="";items=[];handleSubmit(n){n.preventDefault(),M(this.text)!=0&&(this.items.push(this.text),this.text="")}},be=[function(e){return function(n){e.handleSubmit(n)}},function(e){return e.text},function(e){return`
        Add #`+(R(e.items)+1)+`
    `},function(e){return e.items}];var re=class extends f{_name="TodoList";items=null},ve=[function(e){return e.items},function(e,n,t){return t}];var F={CounterReducer:L,TodoReducer:W,MenuBar:G,Counter_x:le,Counter:J,HomePage_x:de,HomePage:j,Layout_x:pe,Layout:q,NotFoundPage:z,CounterPage:Q,TodoAppPage:X,StatefulCounter_x:fe,StatefulCounter:Y,StatefulTodoApp_x:he,StatefulTodoApp:Z,ItemComponent:ee,SomeComponent:ne,TestComponent_x:xe,TestComponent:te,TodoApp_x:be,TodoApp:oe,TodoList_x:ve,TodoList:re};function ge(e){let n=new Proxy(e,{set(t,o,r){var u=t[o]!==r,m=Reflect.set(t,o,r);if(u&&o in t.$$r)for(let c in t.$$r[o]){let d=t.$$r[o][c];d[0].apply(null,d[1])}return m}});return e.$=e,n}function Ce(e,n){let t=$(e),o=e.childNodes.length,r=t.current+3;r=r>o?o:r;let u=[];for(let c=t.current+1;c<r;c++){let d=e.childNodes[c];if(d.nodeType===8)return t.current=c,t.invalid=t.invalid.concat(u),d;u.push(c)}t.added++,t.invalid=t.invalid.concat(u),console.log("Hydrate comment not found",n);let m=document.createComment(n);return t.current=t.current+u.length+1,o>t.current?e.insertBefore(m,e.childNodes[t.current]):e.appendChild(m)}function Te(e,n){let t=$(e),o=e.childNodes.length,r=t.current+3;r=r>o?o:r;let u=[];for(let c=t.current+1;c<r;c++){let d=e.childNodes[c];if(d.nodeType===1&&d.nodeName.toLowerCase()===n)return t.current=c,t.invalid=t.invalid.concat(u),d;u.push(c)}t.added++,t.invalid=t.invalid.concat(u),console.warn("Hydrate not found",n);let m=document.createElement(n);return t.current=t.current+u.length+1,o>t.current?e.insertBefore(m,e.childNodes[t.current]):e.appendChild(m)}function P(e,n,t,o){let r=[e];o&&(r=r.concat(o.arguments));let u=n.expression?e.$$t[n.code].apply(null,r):n.content??"";t.nodeValue!==u&&(t.nodeValue=u)}function ye(e,n,t,o){let r=$(e),u=e.childNodes.length,m=r.current+3;m=m>u?u:m;let c=[],d=r.current>-1?r.current:r.current+1;for(let i=d;i<m;i++){let v=e.childNodes[i];if(v.nodeType===3){if(i===r.current)break;return r.current=i,r.invalid=r.invalid.concat(c),P(n,t,v,o),v}i!==r.current&&c.push(i)}r.added++,r.invalid=r.invalid.concat(c);let T=document.createTextNode("");return P(n,t,T,o),r.current=r.current+c.length+1,u>r.current?e.insertBefore(T,e.childNodes[r.current]):e.appendChild(T)}function ue(e,n,t,o,r){let u=null;if(n.children){u="";for(let m=0;m<n.children.length;m++){let c=n.children[m],d=[e];r&&(d=d.concat(r.arguments));let T=c.expression?e.$$t[c.code].apply(null,d):c.content??"";u=m===0?T:u+(T??"")}}u!==null?u!==t.getAttribute(o)&&t.setAttribute(o,u):t.removeAttribute(o)}function H(e,n){for(let t in e.track){let o=e.track[t];delete n.$$r[o.path][o.id]}if(e.track=[],e.components=[],e.children){for(let t in e.children)H(e.children[t],n);e.children={}}e.parent&&delete e.parent.children[e.id]}function _e(e,n,t,o,r,u,m){let c=[e];m.arguments&&(c=c.concat(m.arguments));let d=e.$$t[t.children[0].forData].apply(null,c),T=Array.isArray(d),i=o,v=!1,k={},w={};for(let l in d){let s=T?+l:l,p=d[s],b=++m.counter,a={id:b,arguments:[...m.arguments],components:[],map:{...m.map},track:[],parent:m,children:{},counter:0};m.children[b]=a;let h=!1;for(let x in r)if(r[x]===p){h=!0,v=!1,i=o;break}else!v&&!(s in k)&&(i=r[x].begin,v=!0);if(k[s]=!0,!h){a.map[t.children[0].forKey]=a.arguments.length,a.arguments.push(s),a.map[t.children[0].forItem]=a.arguments.length,a.arguments.push(p);let x={map:{...u.map},storage:{...u.storage}},C=y(i,!0,void 0,"b"+U());N(i,e,[n],a,x,!1,!0);let I=y(i,!0,void 0,C._anchor);s in r&&(w[s]=r[s]),r[s]={key:s,value:p,begin:C,end:I,scope:a}}}for(let l in r)if(!(l in k)){let s=r[l].end;for(;s.previousSibling._anchor!==s._anchor;)s.previousSibling.remove();r[l].begin.remove(),s.remove(),H(r[l].scope,e),delete r[l]}for(let l in w){let s=w[l].end;for(;s.previousSibling._anchor!==s._anchor;)s.previousSibling.remove();w[l].begin.remove(),H(w[l].scope,e),s.remove()}}function ie(e,n,t,o,r,u,m,c){let d=!0;for(let i=0;i<c;i++)d=d&&!u.values[i];o.children&&(d=d&&!!e.$$t[o.children[0].code](e));let T={map:{...m.map},storage:{...m.storage}};if(u.values[c]!==d)if(u.values[c]=d,d){let i=++t.parent.counter,v={id:i,arguments:t.parent.arguments,components:t.components,map:t.parent.map,track:t.track,parent:t.parent,children:{},counter:0};t.parent.children[i]=v,N(r,e,[n],v,T,!1,!0)}else for(H(t,e);r.previousSibling._anchor!==r._anchor;)r.previousSibling.remove()}function Ne(e,n,t){let o=n.expression?e.$$t[n.code](e):n.content??"";t.nodeValue!==o&&(t.nodeValue=o)}var Ie=0;function E(e,n,t,o){e.$$r[n]||(e.$$r[n]={});let r=++Ie;t.track.push({id:r,path:n}),e.$$r[n][r]=o}function V(e){let n="value";switch(e.t){case"t":{n="tag";break}case"a":{n="attr";break}case void 0:case"v":{n="value";break}case"c":{n="component";break}case"x":{n="text";break}case"m":{n="comment";break}case"r":{n="root";break}default:throw new Error("Type "+e.t+" is not defined in build")}if(e.type=n,delete e.t,e.c&&(e.content=e.c,delete e.c),e.e&&(e.expression=e.e,delete e.e),e.a){e.attributes=e.a,delete e.a;for(let t in e.attributes)V(e.attributes[t])}if(e.i){e.directives=e.i,delete e.i;for(let t in e.directives)V(e.directives[t])}if(e.h){e.children=e.h,delete e.h;for(let t in e.children)V(e.children[t])}}function N(e,n,t,o,r,u=!0,m=!1){let c=null,d=!1;for(let T=0;T<t.length;T++){let i=t[T],v=e,k=!1,w=!1;switch(i.type){case"tag":{if(i.directives){let s=r||{map:{},storage:{}},p=[n];o.arguments&&(p=p.concat(o.arguments));for(let b=0;b<i.directives.length;b++){let a=i.directives[b];if(!(b in s.map)){switch(s.map[b]=!0,a.content){case"if":{c={values:[],index:0,subs:[]};let h=!!n.$$t[a.children[0].code].apply(null,p);c.values.push(h);let x=u?$(e):void 0,C=y(e,m,x),I={map:{...s.map},storage:{...s.storage}},A=++o.counter,_={id:A,arguments:o.arguments,components:[],map:o.map,track:[],parent:o,children:{},counter:0};o.children[A]=_,h&&N(e,n,[i],_,s,u,m);let S=y(e,m,x,C._anchor);if(a.children[0].subs)for(let g in a.children[0].subs){let B=a.children[0].subs[g];c.subs.push(B),E(n,B,o,[ie,[n,i,_,a,S,c,I,c.index]])}c.index++,k=!0;break}case"else-if":{if(c){let h=!0;for(let g=0;g<c.index;g++)h=h&&!c.values[g];h=h&&!c.values[c.index-1]&&!!n.$$t[a.children[0].code].apply(null,p),c.values.push(h);let x=u?$(e):void 0,C=y(e,m,x),I={map:{...s.map},storage:{...s.storage}},A=++o.counter,_={id:A,arguments:o.arguments,components:[],map:o.map,track:[],parent:o,children:{},counter:0};o.children[A]=_,h&&N(e,n,[i],_,s,u,m);let S=y(e,m,x,C._anchor);a.children[0].subs&&(c.subs=c.subs.concat(a.children[0].subs));for(let g in c.subs){let B=c.subs[g];E(n,B,o,[ie,[n,i,_,a,S,c,I,c.index]])}c.index++,k=!0}else console.warn("Directive else-if has missing previous if/else-if",a.content,a);break}case"else":{if(c){let h=!0;for(let g=0;g<c.index;g++)h=h&&!c.values[g];c.values.push(h);let x=u?$(e):void 0,C=y(e,m,x),I={map:{...s.map},storage:{...s.storage}},A=++o.counter,_={id:A,arguments:o.arguments,components:[],map:o.map,track:[],parent:o,children:{},counter:0};o.children[A]=_,h&&N(e,n,[i],_,s,u,m);let S=y(e,m,x,C._anchor);for(let g in c.subs){let B=c.subs[g];E(n,B,o,[ie,[n,i,_,a,S,c,I,c.index]])}c.index++,k=!0}else console.warn("Directive else has missing previous if/else-if",a.content,a);break}case"foreach":{let h=n.$$t[a.children[0].forData].apply(null,p),x=u?$(e):void 0,C=y(e,m,x),I=Array.isArray(h),A={};for(let S in h){let g=I?+S:S,B=h[g],se=++o.counter,D={id:se,arguments:[...o.arguments],components:[],map:{...o.map},track:[],parent:o,children:{},counter:0};o.children[se]=D,D.map[a.children[0].forKey]=D.arguments.length,D.arguments.push(g),D.map[a.children[0].forItem]=D.arguments.length,D.arguments.push(B);let ke={map:{...s.map},storage:{...s.storage}},me=y(e,m,x,"b"+U());N(e,n,[i],D,ke,u,m);let Ae=y(e,m,x,me._anchor);A[g]={key:g,value:B,begin:me,end:Ae,scope:D}}let _=y(e,m,x,C._anchor);if(a.children[0].subs)for(let S in a.children[0].subs){let g=a.children[0].subs[S],B={map:{...s.map},storage:{...s.storage}};E(n,g,o,[_e,[n,i,a,_,A,B,o]])}k=!0;break}default:{console.warn("Directive not implemented",a.content,a),k=!0;break}}if(k)break}}if(k)continue}if(i.content==="template"){d=m;break}if(i.content==="slot"){d=m;let s="default";if(i.attributes)for(let p in i.attributes)i.attributes[p].content==="name"&&(s=i.attributes[p].children[0].content);if(s in o.slots){let p=o.slots[s];p.node.unpacked||(V(p.node),p.node.unpacked=!0),N(v,p.instance,p.node.children,p.scope,void 0,u,d)}else i.children&&N(v,n,i.children,o,void 0,u,d);continue}w=!0;let l=i.expression?n.$$t[i.code](n):i.content??"";v=u?Te(e,l):m?e.parentElement.insertBefore(document.createElement(l),e):e.appendChild(document.createElement(l));break}case"text":{let l;if(u?l=ye(e,n,i,o):(l=document.createTextNode(""),P(n,i,l,o),m?e.parentElement.insertBefore(l,e):e.appendChild(l)),i.subs)for(let s in i.subs){let p=i.subs[s];E(n,p,o,[P,[n,i,l,o]])}break}case"comment":{let l=i.expression?n.$$t[i.code](n):i.content??"",s=u?Ce(e,l):m?e.parentElement.insertBefore(document.createComment(l),e):e.appendChild(document.createComment(l));if(i.subs)for(let p in i.subs){let b=i.subs[p];E(n,b,o,[Ne,[n,i,s]])}break}case"component":{let l=++o.counter,s={id:l,arguments:[...o.arguments],components:[],map:{...o.map},track:[],parent:o,children:{},counter:0};if(o.children[l]=s,s.slots={},i.slots)for(let p in i.slots)s.slots[p]={node:i.slots[p],scope:o,instance:n};ce(e,i.content,s);continue}default:{console.warn("Node type not implemented",i);break}}if(w){if(i.attributes){let l=u?v.getAttributeNames():null,s=u?{}:null;for(let p in i.attributes){let b=i.attributes[p],a=b.expression?n.$$t[b.code](n):b.content??"";if(a[0]==="("){let h=a.substring(1,a.length-1);if(b.children){let x=n.$$t[b.dynamic?b.dynamic.code:b.children[0].code](n);v.addEventListener(h,x)}}else{u&&(s[a]=!0),ue(n,b,v,a,o);let h=[];if(b.children)for(let x in b.children){let C=b.children[x];C.subs&&(h=h.concat(C.subs))}if(h)for(let x in h){let C=h[x];E(n,C,o,[ue,[n,b,v,a,o]])}}}if(u)for(let p=0;p<l.length;p++)l[p]in s||v.removeAttribute(l[p])}else if(u){let l=v.getAttributeNames();for(let s=0;s<l.length;s++)v.removeAttribute(l[s])}}i.children&&N(v,n,i.children,o,void 0,u,d)}}function ce(e,n,t){if(!(n in O.list))throw new Error(`Component ${n} not found.`);if(!(n in F))throw new Error(`Component ${n} not found.`);let o=O.list[n].nodes,r=ge(new F[n]),u=n+"_x";if(u in F&&(r.$$t=F[u]),e&&o){o.unpacked||(V(o),o.unpacked=!0);let m=o.children;m&&N(e,r,m,t)}}var De=()=>({version:"2.0.1"});globalThis.Viewi=De;console.log("Viewi entry");var we=document.getElementById("counter");function Ee(e){ce(we,e,{id:0,arguments:[],components:[],map:{},track:[],children:{},counter:0});for(let n in K){let t=K[n];for(let o=t.target.childNodes.length-1;o>=t.current+1;o--)t.target.childNodes[o].remove();for(let o=t.invalid.length-1;o>=0;o--)t.target.childNodes[t.invalid[o]].remove()}}(async()=>(O.list=await(await fetch("/assets/components.json")).json(),setTimeout(()=>Ee("TestComponent"),500)))();})();
