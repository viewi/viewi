(()=>{var Ve=0,be=0,q={};function D(e){return e.__aid||(e.__aid=++Ve,q[e.__aid]={current:-1,target:e,invalid:[],added:0}),q[e.__aid]}function X(){return++be}function A(e,n=!1,t,o){let i=document.createTextNode("");return i._anchor=o??"#"+ ++be,t&&t.current++,n||t&&e.childNodes.length>t.current?(t?e:e.parentElement).insertBefore(i,t?e.childNodes[t.current]:e):e.appendChild(i),i}var Le={list:{}},U=Le;var W=class{count=0;increment(){this.count++}decrement(){this.count--}};var Y=class{items=[];addNewItem(n){this.items.push(n)}};var d=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(n,t){this.$_callbacks&&n in this.$_callbacks&&this.$_callbacks[n](t)}};var Z=class extends d{_name="MenuBar"};function R(e){var n=e+"";return n.length}var ee=class extends d{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},ve=[function(e){return function(n){e.decrement()}},function(e){return e.count%10+12},function(e){return`
    Count `+e.count+" "+R(e.message)+`
`},function(e){return`
Count `+e.count+" "+R(e.message)+`
`},function(e){return function(n){e.increment()}},function(e){return function(n){e.increment(n)}},function(e){return e.increment.bind(e)},function(e){return e.message}];var ne=class extends d{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},ge=[function(e){return e.title},function(e){return e.title}];var te=class extends d{_name="Layout";title="Viewi"},Ce=[function(e){return`
        `+e.title+` | Viewi
    `}];var oe=class extends d{_name="NotFoundPage"};var re=class extends d{_name="CounterPage"};var ie=class extends d{_name="TodoAppPage"};var ce=class extends d{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(n){super(),this.count=n===void 0?0:n,this.counter=new W}$calculate(){this.count++}},ye=[function(e){return function(n){e.counter.decrement()}},function(e){return e.__id},function(e){return e.counter.count},function(e){return function(n){e.counter.increment()}}];function z(e,n){let t,o=0;if(e===null||typeof e>"u")return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;n==="COUNT_RECURSIVE"&&(n=1),n!==1&&(n=0);for(t in e)e.hasOwnProperty(t)&&(o++,n===1&&e[t]&&(e[t].constructor===Array||e[t].constructor===Object)&&(o+=z(e[t],1)));return o}var se=class extends d{_name="StatefulTodoApp";text="";todo=null;constructor(n){super(),this.todo=n}handleSubmit(n){n.preventDefault(),R(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},Te=[function(e){return function(n){e.handleSubmit(n)}},function(e){return e.text},function(e){return`
        Add #`+(z(e.todo.items)+1)+`
    `},function(e){return e.todo.items}];var ue=class extends d{_name="ItemComponent"};var me=class extends d{_name="SomeComponent"};var ae=class extends d{_name="TestComponent";name="MyName";_name2_Test="MyName_2";empty="";null=null;url="/home";attr="title";event="(click)";arr=["a","b","c"];arrWithKeys={a:"Apple",b:"Orange",c:"Lemon"};arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},b:{a:"Apple",b:"Orange",c:"Lemon"},c:{a:"Apple",b:"Orange",c:"Lemon"}};ifValue=!0;ifElseValue=!0;nestedIf=!0;dynamic="div";dynamic2="ItemComponent";getName(n){var t=60;return n??"DefaultName"}addTodo(){this.arrNested={a:{a:"Apple",b:"Orange",c:"Lemon"},d:{R:"Rat",T:"Dog",G:"Cat"},b:{a:"Apple",b:"Orange",c:"Lemon"}}}onEvent(n){n.preventDefault()}toggleIf(){this.ifValue=!this.ifValue,this.arr=this.ifValue?["a","b","c"]:["x","b","r"]}toggleElseIf(){this.ifElseValue=!this.ifElseValue}},Ne=[function(e){return"Tag test "+e.name+" "+e._name2_Test},function(e){return`
    $notAVar `+e.getName()+" "+e.getName(e.name)+`
    Nested
    `},function(e){return e.url},function(e){return e.empty},function(e){return e.null},function(e){return e.attr},function(e){return expression.bind(e)},function(e){return e.event},function(e){return e.onEvent.bind(e)},function(e){return function(n){e.dynamic=e.dynamic==="div"?"ItemComponent":"div"}},function(e){return`
`+e.dynamic+" "+e.dynamic2+`
`},function(e){return e.dynamic},function(e){return"Tag or component "+e.dynamic+" "+e.dynamic2},function(e){return e.dynamic2},function(e){return"Tag or component "+e.dynamic+" "+e.dynamic2},function(e){return"Custom "+e.name+" Slot"},function(e){return"Custom "+e.name+` slot
        `},function(e){return"Custom header "+e.name+" inside div"},function(e){return"Custom "+e.name+" footer"},function(e){return e.addTodo.bind(e)},function(e){return e.nestedIf},function(e){return e.name},function(e){return e.arr},function(e,n,t){return e.ifElseValue},function(e,n,t){return t},function(e,n,t){return t},function(e,n,t){return t},function(e,n,t){return e.nestedIf},function(e,n,t){return e.name},function(e){return e.arr},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return n+". "},function(e,n,t){return t},function(e,n,t){return t},function(e){return e.arrWithKeys},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return n+": "},function(e,n,t){return n},function(e,n,t){return t},function(e,n,t){return t},function(e){return e.ifValue},function(e){return e.arrNested},function(e,n,t){return t},function(e,n,t,o,i){return n},function(e,n,t,o,i){return o},function(e,n,t,o,i){return i},function(e,n,t,o,i){return n+". "+o+". "+i},function(e){return e.arrNested},function(e,n,t){return n==="b"},function(e,n,t){return t},function(e,n,t,o,i){return n},function(e,n,t,o,i){return o},function(e,n,t,o,i){return i},function(e,n,t,o,i){return n+". "+o+". "+i},function(e){return e.toggleIf.bind(e)},function(e){return e.toggleElseIf.bind(e)},function(e){return function(n){e.nestedIf=!e.nestedIf}},function(e){return function(n){e.name="Viewi Junior"}},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.ifValue},function(e){return e.ifElseValue},function(e){return e.arr},function(e,n,t){return t}];var le=class extends d{_name="TodoApp";text="";items=[];handleSubmit(n){n.preventDefault(),R(this.text)!=0&&(this.items.push(this.text),this.text="")}},_e=[function(e){return function(n){e.handleSubmit(n)}},function(e){return e.text},function(e){return`
        Add #`+(z(e.items)+1)+`
    `},function(e){return e.items}];var pe=class extends d{_name="TodoList";items=null},ke=[function(e){return e.items},function(e,n,t){return t}];var Q={CounterReducer:W,TodoReducer:Y,MenuBar:Z,Counter_x:ve,Counter:ee,HomePage_x:ge,HomePage:ne,Layout_x:Ce,Layout:te,NotFoundPage:oe,CounterPage:re,TodoAppPage:ie,StatefulCounter_x:ye,StatefulCounter:ce,StatefulTodoApp_x:Te,StatefulTodoApp:se,ItemComponent:ue,SomeComponent:me,TestComponent_x:Ne,TestComponent:ae,TodoApp_x:_e,TodoApp:le,TodoList_x:ke,TodoList:pe};function Ae(e){let n=new Proxy(e,{set(t,o,i){var s=t[o]!==i,u=Reflect.set(t,o,i);if(s&&o in t.$$r)for(let c in t.$$r[o]){let a=t.$$r[o][c];a[0].apply(null,a[1])}return u}});return e.$=e,n}function Se(e,n){let t=D(e),o=e.childNodes.length,i=t.current+3;i=i>o?o:i;let s=[];for(let c=t.current+1;c<i;c++){let a=e.childNodes[c];if(a.nodeType===8)return t.current=c,t.invalid=t.invalid.concat(s),a;s.push(c)}t.added++,t.invalid=t.invalid.concat(s),console.log("Hydrate comment not found",n);let u=document.createComment(n);return t.current=t.current+s.length+1,o>t.current?e.insertBefore(u,e.childNodes[t.current]):e.appendChild(u)}function $e(e,n){let t=D(e),o=e.childNodes.length,i=t.current+3;i=i>o?o:i;let s=[];for(let c=t.current+1;c<i;c++){let a=e.childNodes[c];if(a.nodeType===1&&a.nodeName.toLowerCase()===n)return t.current=c,t.invalid=t.invalid.concat(s),a;s.push(c)}t.added++,t.invalid=t.invalid.concat(s),console.warn("Hydrate not found",n);let u=document.createElement(n);return t.current=t.current+s.length+1,o>t.current?e.insertBefore(u,e.childNodes[t.current]):e.appendChild(u)}function G(e,n,t,o){let i=[e];o&&(i=i.concat(o.arguments));let s=n.expression?e.$$t[n.code].apply(null,i):n.content??"";t.nodeValue!==s&&(t.nodeValue=s),t.parentNode&&!document.body.contains(t)&&console.log("Element is missing from the page",t)}function Be(e,n,t,o){let i=D(e),s=e.childNodes.length,u=i.current+3;u=u>s?s:u;let c=[],a=i.current>-1?i.current:i.current+1;for(let r=a;r<u;r++){let l=e.childNodes[r];if(l.nodeType===3){if(r===i.current)break;return i.current=r,i.invalid=i.invalid.concat(c),G(n,t,l,o),l}r!==i.current&&c.push(r)}i.added++,i.invalid=i.invalid.concat(c);let v=document.createTextNode("");return G(n,t,v,o),i.current=i.current+c.length+1,s>i.current?e.insertBefore(v,e.childNodes[i.current]):e.appendChild(v)}function J(e,n,t,o,i){let s=null;if(n.children){s="";for(let u=0;u<n.children.length;u++){let c=n.children[u],a=[e];i&&(a=a.concat(i.arguments));let v=c.expression?e.$$t[c.code].apply(null,a):c.content??"";s=u===0?v:s+(v??"")}}s!==null?s!==t.getAttribute(o)&&t.setAttribute(o,s):t.removeAttribute(o)}function H(e,n){for(let t in e.track){let o=e.track[t];delete n.$$r[o.path][o.id]}if(e.track=[],e.components=[],e.children){for(let t in e.children)H(e.children[t],n);e.children={}}e.parent&&(delete e.parent.children[e.id],delete e.parent)}function Ie(e,n,t,o,i,s,u){let c=[e];u.arguments&&(c=c.concat(u.arguments));let a=e.$$t[t.children[0].forData].apply(null,c),v=Array.isArray(a),r=o,l=!1,g={},k={};for(let C in a){let m=v?+C:C,T=a[m],_=++u.counter,f={id:_,arguments:[...u.arguments],components:[],map:{...u.map},track:[],parent:u,children:{},counter:0};u.children[_]=f;let I=!1;for(let b in i)if(i[b]===T){I=!0,l=!1,r=o;break}else!l&&!(m in g)&&(r=i[b].begin,l=!0);if(g[m]=!0,!I){f.map[t.children[0].forKey]=f.arguments.length,f.arguments.push(m),f.map[t.children[0].forItem]=f.arguments.length,f.arguments.push(T);let b={map:{...s.map},storage:{...s.storage}},p=A(r,!0,void 0,"b"+X());S(r,e,[n],f,b,!1,!0);let h=A(r,!0,void 0,p._anchor);m in i&&(k[m]=i[m]),i[m]={key:m,value:T,begin:p,end:h,scope:f}}}for(let C in i)if(!(C in g)){let m=i[C].end;for(;m.previousSibling._anchor!==m._anchor;)m.previousSibling.remove();i[C].begin.remove(),m.remove(),H(i[C].scope,e),delete i[C]}for(let C in k){let m=k[C].end;for(;m.previousSibling._anchor!==m._anchor;)m.previousSibling.remove();k[C].begin.remove(),H(k[C].scope,e),m.remove()}}function de(e,n,t,o,i,s,u){let c=!0;for(let r=0;r<u;r++)c=c&&!i.values[r];o.children&&(c=c&&!!e.$$t[o.children[0].code](e));let a=t.anchorNode,v={map:{...s.map},storage:{...s.storage}};if(i.values[u]!==c){let r=t.scope.parent;if(i.values[u]=c,c){let l=++r.counter,g={id:l,arguments:[...r.arguments],components:[],map:{...r.map},track:[],parent:r,children:{},counter:0};t.scope=g,r.children[l]=g,S(a,e,[n],g,v,!1,!0)}else for(H(t.scope,e),t.scope={id:-1,arguments:[],components:[],map:{},track:[],parent:r,children:{},counter:0};a.previousSibling._anchor!==a._anchor;)a.previousSibling.remove()}}function De(e,n,t){let o=n.expression?e.$$t[n.code](e):n.content??"";t.nodeValue!==o&&(t.nodeValue=o)}var He=0;function M(e,n,t,o){e.$$r[n]||(e.$$r[n]={});let i=++He;t.track.push({id:i,path:n}),e.$$r[n][i]=o}function F(e){let n="value";switch(e.t){case"t":{n="tag";break}case"a":{n="attr";break}case void 0:case"v":{n="value";break}case"c":{n="component";break}case"x":{n="text";break}case"m":{n="comment";break}case"r":{n="root";break}default:throw new Error("Type "+e.t+" is not defined in build")}if(e.type=n,delete e.t,e.c&&(e.content=e.c,delete e.c),e.e&&(e.expression=e.e,delete e.e),e.a){e.attributes=e.a,delete e.a;for(let t in e.attributes)F(e.attributes[t])}if(e.i){e.directives=e.i,delete e.i;for(let t in e.directives)F(e.directives[t])}if(e.h){e.children=e.h,delete e.h;for(let t in e.children)F(e.children[t])}}function Ee(e,n,t){let o=n.expression?e.$$t[n.code](e):n.content??"",i=n.type==="component"||n.expression&&fe(o),s=t.anchorNode,u=t.scope.parent;for(H(t.scope,e);s.previousSibling._anchor!==s._anchor;)s.previousSibling.remove();let c=++u.counter,a={id:c,arguments:[...u.arguments],components:[],map:{...u.map},track:[],parent:u,children:{},counter:0};if(t.scope=a,u.children[c]=a,i){if(a.slots={},n.slots){let v=++a.counter,r={id:v,arguments:[...u.arguments],components:[],map:{...u.map},track:[],parent:a,children:{},counter:0,slots:u.slots};a.children[v]=r;for(let l in n.slots)a.slots[l]={node:n.slots[l],scope:r,instance:e}}j(s,o,a,!1,!0);return}else{let v=s.parentElement.insertBefore(document.createElement(o),s);if(n.attributes)for(let r in n.attributes){let l=n.attributes[r],g=l.expression?e.$$t[l.code](e):l.content??"";if(g[0]==="("){let k=g.substring(1,g.length-1);if(l.children){let C=e.$$t[l.dynamic?l.dynamic.code:l.children[0].code](e);v.addEventListener(k,C)}}else{J(e,l,v,g,a);let k=[];if(l.children)for(let C in l.children){let m=l.children[C];m.subs&&(k=k.concat(m.subs))}if(k)for(let C in k){let m=k[C];M(e,m,a,[J,[e,l,v,g,a]])}}}n.children&&S(v,e,n.children,a,void 0,!1,!1)}}function S(e,n,t,o,i,s=!0,u=!1){let c=null,a=!1;for(let v=0;v<t.length;v++){let r=t[v],l=e,g=!1,k=!1,C=o;switch(r.type){case"tag":case"component":{if(r.directives){let p=i||{map:{},storage:{}},h=[n];o.arguments&&(h=h.concat(o.arguments));for(let V=0;V<r.directives.length;V++){let x=r.directives[V];if(!(V in p.map)){switch(p.map[V]=!0,x.content){case"if":{c={values:[],index:0,subs:[]};let N=!!n.$$t[x.children[0].code].apply(null,h);c.values.push(N);let $=s?D(e):void 0,K=A(e,u,$),O={map:{...p.map},storage:{...p.storage}},E=++o.counter,B={id:E,arguments:o.arguments,components:[],map:o.map,track:[],parent:o,children:{},counter:0};o.children[E]=B,N&&S(e,n,[r],B,p,s,u);let L=A(e,u,$,K._anchor);if(x.children[0].subs)for(let y in x.children[0].subs){let w=x.children[0].subs[y];c.subs.push(w),M(n,w,o,[de,[n,r,{scope:B,anchorNode:L},x,c,O,c.index]])}c.index++,g=!0;break}case"else-if":{if(c){let N=!0;for(let y=0;y<c.index;y++)N=N&&!c.values[y];N=N&&!c.values[c.index-1]&&!!n.$$t[x.children[0].code].apply(null,h),c.values.push(N);let $=s?D(e):void 0,K=A(e,u,$),O={map:{...p.map},storage:{...p.storage}},E=++o.counter,B={id:E,arguments:o.arguments,components:[],map:o.map,track:[],parent:o,children:{},counter:0};o.children[E]=B,N&&S(e,n,[r],B,p,s,u);let L=A(e,u,$,K._anchor);x.children[0].subs&&(c.subs=c.subs.concat(x.children[0].subs));for(let y in c.subs){let w=c.subs[y];M(n,w,o,[de,[n,r,{scope:B,anchorNode:L},x,c,O,c.index]])}c.index++,g=!0}else console.warn("Directive else-if has missing previous if/else-if",x.content,x);break}case"else":{if(c){let N=!0;for(let y=0;y<c.index;y++)N=N&&!c.values[y];c.values.push(N);let $=s?D(e):void 0,K=A(e,u,$),O={map:{...p.map},storage:{...p.storage}},E=++o.counter,B={id:E,arguments:o.arguments,components:[],map:o.map,track:[],parent:o,children:{},counter:0};o.children[E]=B,N&&S(e,n,[r],B,p,s,u);let L=A(e,u,$,K._anchor);for(let y in c.subs){let w=c.subs[y];M(n,w,o,[de,[n,r,{scope:B,anchorNode:L},x,c,O,c.index]])}c.index++,g=!0}else console.warn("Directive else has missing previous if/else-if",x.content,x);break}case"foreach":{let N=n.$$t[x.children[0].forData].apply(null,h),$=s?D(e):void 0,K=A(e,u,$),O=Array.isArray(N),E={};for(let L in N){let y=O?+L:L,w=N[y],he=++o.counter,P={id:he,arguments:[...o.arguments],components:[],map:{...o.map},track:[],parent:o,children:{},counter:0};o.children[he]=P,P.map[x.children[0].forKey]=P.arguments.length,P.arguments.push(y),P.map[x.children[0].forItem]=P.arguments.length,P.arguments.push(w);let we={map:{...p.map},storage:{...p.storage}},xe=A(e,u,$,"b"+X());S(e,n,[r],P,we,s,u);let Me=A(e,u,$,xe._anchor);E[y]={key:y,value:w,begin:xe,end:Me,scope:P}}let B=A(e,u,$,K._anchor);if(x.children[0].subs)for(let L in x.children[0].subs){let y=x.children[0].subs[L],w={map:{...p.map},storage:{...p.storage}};M(n,y,o,[Ie,[n,r,x,B,E,w,o]])}g=!0;break}default:{console.warn("Directive not implemented",x.content,x),g=!0;break}}if(g)break}}if(g)continue}let m=r.expression?n.$$t[r.code](n):r.content??"",T=r.subs,_=r.type==="component"||r.expression&&fe(m),f,I,b;if(T&&(f=s?D(e):void 0,I=A(e,u,f)),T||_){let p=++o.counter;b={id:p,arguments:[...o.arguments],components:[],map:{...o.map},track:[],parent:o,children:{},counter:0},o.children[p]=b,C=b}if(_){if(b.slots={},r.slots){let p=++b.counter,h={id:p,arguments:[...o.arguments],components:[],map:{...o.map},track:[],parent:b,children:{},counter:0,slots:o.slots};b.children[p]=h;for(let V in r.slots)b.slots[V]={node:r.slots[V],scope:h,instance:n}}j(e,m,b,s,u)}else{if(r.content==="template"){a=u;break}if(r.content==="slot"){a=u;let p="default";if(r.attributes)for(let h in r.attributes)r.attributes[h].content==="name"&&(p=r.attributes[h].children[0].content);if(p in o.slots){let h=o.slots[p];h.node.unpacked||(F(h.node),h.node.unpacked=!0),S(l,h.instance,h.node.children,h.scope,void 0,s,a)}else r.children&&S(l,n,r.children,o,void 0,s,a);continue}k=!0,l=s?$e(e,m):u?e.parentElement.insertBefore(document.createElement(m),e):e.appendChild(document.createElement(m))}if(T){let p=A(e,u,f,I._anchor);if(r.subs)for(let h in r.subs){let V=r.subs[h];M(n,V,o,[Ee,[n,r,{scope:b,anchorNode:p}]])}}if(_)continue;break}case"text":{let m;if(s?m=Be(e,n,r,o):(m=document.createTextNode(""),G(n,r,m,o),u?e.parentElement.insertBefore(m,e):e.appendChild(m)),r.subs)for(let T in r.subs){let _=r.subs[T];M(n,_,o,[G,[n,r,m,o]])}break}case"comment":{let m=r.expression?n.$$t[r.code](n):r.content??"",T=s?Se(e,m):u?e.parentElement.insertBefore(document.createComment(m),e):e.appendChild(document.createComment(m));if(r.subs)for(let _ in r.subs){let f=r.subs[_];M(n,f,o,[De,[n,r,T]])}break}default:{console.warn("Node type not implemented",r);break}}if(k){if(r.attributes){let m=s?l.getAttributeNames():null,T=s?{}:null;for(let _ in r.attributes){let f=r.attributes[_],I=f.expression?n.$$t[f.code](n):f.content??"";if(I[0]==="("){let b=I.substring(1,I.length-1);if(f.children){let p=n.$$t[f.dynamic?f.dynamic.code:f.children[0].code](n);l.addEventListener(b,p)}}else{s&&(T[I]=!0),J(n,f,l,I,o);let b=[];if(f.children)for(let p in f.children){let h=f.children[p];h.subs&&(b=b.concat(h.subs))}if(b)for(let p in b){let h=b[p];M(n,h,o,[J,[n,f,l,I,o]])}}}if(s)for(let _=0;_<m.length;_++)m[_]in T||l.removeAttribute(m[_])}else if(s){let m=l.getAttributeNames();for(let T=0;T<m.length;T++)l.removeAttribute(m[T])}}r.children&&S(l,n,r.children,C,void 0,s,a)}}function j(e,n,t,o=!1,i=!1){if(!(n in U.list))throw new Error(`Component ${n} not found.`);if(!(n in Q))throw new Error(`Component ${n} not found.`);let s=U.list[n].nodes,u=Ae(new Q[n]),c=n+"_x";if(c in Q&&(u.$$t=Q[c]),e&&s){s.unpacked||(F(s),s.unpacked=!0);let a=s.children;a&&S(e,u,a,t,void 0,o,i)}}function fe(e){return e in U.list}var Ke=()=>({version:"2.0.1"});globalThis.Viewi=Ke;console.log("Viewi entry");var Oe=document.getElementById("counter");function Re(e){j(Oe,e,{id:0,arguments:[],components:[],map:{},track:[],children:{},counter:0},!0,!1);for(let n in q){let t=q[n];for(let o=t.target.childNodes.length-1;o>=t.current+1;o--)t.target.childNodes[o].remove();for(let o=t.invalid.length-1;o>=0;o--)t.target.childNodes[t.invalid[o]].remove()}}(async()=>(U.list=await(await fetch("/assets/components.json")).json(),setTimeout(()=>Re("TestComponent"),500)))();})();
