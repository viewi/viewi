(()=>{var f=class{count=0;increment(){this.count++}decrement(){this.count--}};var b=class{items=[];addNewItem(t){this.items.push(t)}};var c=class{_props={};$_callbacks={};_refs={};_slots={};_element=null;$$t=[];$$r={};$;_name="BaseComponent";emitEvent(t,n){this.$_callbacks&&t in this.$_callbacks&&this.$_callbacks[t](n)}};var _=class extends c{_name="MenuBar"};function h(e){var t=e+"";return t.length}var $=class extends c{_name="Counter";count=0;message="My message";increment(){this.count++,this.message+="!"}decrement(){this.count--}},S=[function(e){return function(t){e.decrement()}},function(e){return e.count%10+12},function(e){return e.count},function(e){return h(e.message)},function(e){return function(t){e.increment()}},function(e){return function(t){e.increment(t)}},function(e){return e.increment.bind(e)},function(e){return e.message}];var C=class extends c{_name="HomePage";title="Viewi v2 - Build reactive front-end with PHP"},I=[function(e){return e.title},function(e){return e.title}];var v=class extends c{_name="Layout";title="Viewi"},F=[function(e){return e.title}];var N=class extends c{_name="NotFoundPage"};var g=class extends c{_name="CounterPage"};var k=class extends c{_name="TodoAppPage"};var B=class extends c{_name="StatefulCounter";counter=null;$message="Secret message";count=null;constructor(t){super(),this.count=t===void 0?0:t,this.counter=new f}$calculate(){this.count++}},R=[function(e){return function(t){e.counter.decrement()}},function(e){return e.__id},function(e){return e.counter.count},function(e){return function(t){e.counter.increment()}}];function x(e,t){let n,r=0;if(e===null||typeof e>"u")return 0;if(e.constructor!==Array&&e.constructor!==Object)return 1;t==="COUNT_RECURSIVE"&&(t=1),t!==1&&(t=0);for(n in e)e.hasOwnProperty(n)&&(r++,t===1&&e[n]&&(e[n].constructor===Array||e[n].constructor===Object)&&(r+=x(e[n],1)));return r}var E=class extends c{_name="StatefulTodoApp";text="";todo=null;constructor(t){super(),this.todo=t}handleSubmit(t){t.preventDefault(),h(this.text)!=0&&(this.todo.addNewItem(this.text),this.text="")}},O=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return x(e.todo.items)+1},function(e){return e.todo.items}];var w=class extends c{_name="TodoApp";text="";items=[];handleSubmit(t){t.preventDefault(),h(this.text)!=0&&(this.items.push(this.text),this.text="")}},D=[function(e){return function(t){e.handleSubmit(t)}},function(e){return e.text},function(e){return x(e.items)+1},function(e){return e.items}];var L=class extends c{_name="TodoList";items=null},U=[function(e){return e.item}];var T={CounterReducer:f,TodoReducer:b,MenuBar:_,Counter_x:S,Counter:$,HomePage_x:I,HomePage:C,Layout_x:F,Layout:v,NotFoundPage:N,CounterPage:g,TodoAppPage:k,StatefulCounter_x:R,StatefulCounter:B,StatefulTodoApp_x:O,StatefulTodoApp:E,TodoApp_x:D,TodoApp:w,TodoList_x:U,TodoList:L};function V(e){let t=new Proxy(e,{set(n,r,o){var i=n[r]!==o,l=Reflect.set(n,r,o);if(i&&r in n.$$r)for(let u in n.$$r[r]){let s=n.$$r[r][u];s[0].apply(null,s[1])}return l}});return e.$=e,t}function H(e){let t="value";switch(e.t){case"t":{t="tag";break}case"a":{t="attr";break}case void 0:case"v":{t="value";break}case"c":{t="component";break}case"x":{t="text";break}case"m":{t="comment";break}case"r":{t="root";break}default:throw new Error("Type "+e.t+" is not defined in build")}if(e.type=t,delete e.t,e.c&&(e.content=e.c,delete e.c),e.e&&(e.expression=e.e,delete e.e),e.a){e.attributes=e.a,delete e.a;for(let n in e.attributes)H(e.attributes[n])}if(e.h){e.children=e.h,delete e.h;for(let n in e.children)H(e.children[n])}}var P={},G=()=>({version:"2.0.1"});globalThis.Viewi=G;console.log("Viewi entry");var M=document.getElementById("counter");function j(e,t,n,r){let o=null;if(t.children){o="";for(let i in t.children){let l=t.children[i];o+=(l.expression?e.$$t[l.code](e):l.content)??""}}o!==null&&n.setAttribute(r,o)}function A(e,t,n){let r=t.expression?e.$$t[t.code](e):t.content??"";n.nodeValue!==r&&(n.nodeValue=r)}var J=0,y={};function q(e){return e.__aid||(e.__aid=++J,y[e.__aid]={current:-1,target:e,invalid:[],added:0}),y[e.__aid]}function K(e,t){let n=q(e),r=e.childNodes.length,o=n.current+3;o=o>r?r:o;let i=[];for(let u=n.current+1;u<o;u++){let s=e.childNodes[u];if(s.nodeType===1&&s.nodeName.toLowerCase()===t)return n.current=u,n.invalid=n.invalid.concat(i),s;i.push(u)}n.added++,console.log("Hydrate not found",t);let l=document.createElement(t);return n.current++,r>n.current?e.insertBefore(l,e.childNodes[n.current]):e.appendChild(document.createElement(t))}function Q(e,t,n){let r=q(e),o=e.childNodes.length,i=r.current+3;i=i>o?o:i;let l=[];for(let s=r.current+1;s<i;s++){let a=e.childNodes[s];if(a.nodeType===3)return r.current=s,r.invalid=r.invalid.concat(l),A(t,n,a),a;l.push(s)}r.added++;let u=document.createTextNode("");return A(t,n,u),r.current++,console.log("Hydrate not found",u),o>r.current?e.insertBefore(u,e.childNodes[r.current]):e.appendChild(u)}function z(e,t,n){for(let r in n){let o=n[r],i=e,l=!0;switch(o.type){case"tag":{let u=o.expression?t.$$t[o.code](t):o.content??"";i=l?K(e,u):e.appendChild(document.createElement(u));break}case"text":{let u;if(l?u=Q(e,t,o):(u=document.createTextNode(""),A(t,o,u),e.appendChild(u)),o.subs)for(let s in o.subs){let a=o.subs[s];t.$$r[a]||(t.$$r[a]=[]),t.$$r[a].push([A,[t,o,u]])}break}default:{console.log("No implemented",o);break}}if(o.attributes)for(let u in o.attributes){let s=o.attributes[u],a=s.expression?t.$$t[s.code](t):s.content??"";if(a[0]==="("){let d=a.substring(1,a.length-1);if(s.children){let m=t.$$t[s.children[0].code](t);i.addEventListener(d,m),console.log("Event",s,d,m)}}else{j(t,s,i,a);let d=[];if(s.children)for(let m in s.children){let p=s.children[m];p.subs&&(d=d.concat(p.subs))}if(d)for(let m in d){let p=d[m];t.$$r[p]||(t.$$r[p]=[]),t.$$r[p].push([j,[t,s,i,a]])}}}o.children&&z(i,t,o.children)}}function W(e){if(!(e in P))throw new Error(`Component ${e} not found.`);if(!(e in T))throw new Error(`Component ${e} not found.`);let t=P[e].nodes,n=V(new T[e]),r=e+"_x";if(r in T&&(n.$$t=T[r]),M&&t){t.unpacked||(H(t),t.unpacked=!0);let o=t.children;console.log(M,n,o),o&&z(M,n,o)}console.log(y);for(let o in y){let i=y[o];for(let l=i.invalid.length-1;l>=0;l--)i.target.childNodes[i.invalid[l]].remove();for(let l=i.current+1;l<i.target.childNodes.length;l++)i.target.childNodes[l].remove()}}(async()=>(P=await(await fetch("/assets/components.json")).json(),W("Counter")))();})();
