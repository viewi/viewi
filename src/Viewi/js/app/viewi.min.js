(function(e,n){function t(){var t=this,s={},c={},a={},d=/^\s*|\s*$/g,l=/;$/g,p={onViewiUrlChange:null};"img,embed,object,link,script,audio,video,style".split(",").each(function(e){a[e]=!0});var u=[],h={svg:!0},f=o?null:new r;this.componentsUrl=VIEWI_PATH+"/components.json"+VIEWI_VERSION,this.components={};var m=document.createElement("a"),v=!1,N=null,b=null,g=!1,y=!1,_=[],k=function(e){return m.href=e,m.pathname},x=function(){for(var e in a)for(var n=document.getElementsByTagName(e),t=0;t<n.length;t++)u.push(n[t])},w=function(){for(var e in t.components._meta.tags.split(",").each(function(e){s[e]=!0}),t.components._meta.boolean.split(",").each(function(e){c[e]=!0}),!o&&t.components._routes.each(function(e){f.register(e.method,e.url,e.component)}),N=t.components._config,x(),v=!0,t.components._startups){var n=t.components._startups[e];try{var r=fe(n);r.setUp()}catch(e){console.error("Start up error in component "+n,e)}}for(var i in g=!0,_)_[i]();o||t.go(location.href,!1)};this.getConfig=function(){return N},this.start=function(e){e&&_.push(e),g||y||(y=!0,"undefined"!=typeof onViewiUrlChange&&"function"==typeof onViewiUrlChange&&(p.onViewiUrlChange=onViewiUrlChange),"undefined"!=typeof ViewiPages?(t.components=JSON.parse(ViewiPages),w()):i.get(this.componentsUrl).then(function(e){t.components=e,w()}),o||(document.addEventListener("click",function(e){if(e=e||window.event,!e.defaultPrevented){for(var n=e.target||e.srcElement,o=n;o.parentNode&&"A"!==o.tagName;)o=o.parentNode;"A"===o.tagName&&o.href&&0===o.href.indexOf(location.origin)&&(b=null,k(o.href),m.hash&&m.pathname===location.pathname||(e.preventDefault(),m.hash&&(b=m.hash),t.go(o.href,!0)))}},!1),window.addEventListener("popstate",function(e){e.state?t.go(e.state.href,!1):t.go(location.href,!1)})))},this.go=function(e,n){var o=k(e);p.onViewiUrlChange&&p.onViewiUrlChange(o);var r=f.resolve(o);if(null==r)throw"Can't resolve route for uri: "+o;n&&window.history.pushState({href:e},"",e),t.render(r.item.action,r.params)};var E=[],V=function(e,n){var t=arguments.length>2&&arguments[2];arguments.length>3&&arguments[3];if(e.expression){var o={call:!0,instance:n},r=["_component","app"];return e.model&&r.push("value"),(t||e.setter)&&r.push("event"),r=e.scope?r.concat(e.scope.stack):r.concat(E),e.code=e.code.replace(d,""),e.code=e.code.replace(l,""),e.setter?r.push(e.isChecked?"if(Array.isArray("+e.code+')) { \n    var notify = viewiBring("notify");\n if ('+e.code+".indexOf(event.target.value) === -1) { \nevent.target.checked && "+e.code+".push(event.target.value);\nevent.target.checked && notify("+e.code+"); \n } else { !event.target.checked && "+e.code+".splice("+e.code+".indexOf(event.target.value), 1);\n!event.target.checked && notify("+e.code+"); \n } \n } else { \n"+e.code+" = event.target.checked;\n } ":e.code+" = event.target.multiple ? Array.prototype.slice.call(event.target.options)\n.where(function(x){ return x.selected; })\n.select(function(x){ return x.value; })\n : event.target.value;"):e.model?r.push(e.code+" = value;"):r.push("return "+e.code+";"),o.code=e.code,o.func=Function.apply(null,r),o}return{call:!1,content:e.content}},C=["template"],I=["if","else-if","else","foreach"],A=["if","else-if","else"],O=[],j=function(e){var n="";switch(e.t){case"t":n="tag";break;case"a":n="attr";break;case void 0:case"v":n="value";break;case"c":n="component";break;case"x":n="text";break;case"m":n="comment";break;default:throw new Error("Type "+e.t+" is not defined in build")}e.type=n,delete e.t,e.content=e.c,delete e.c,e.e&&(e.expression=e.e,delete e.e),e.a&&(e.attributes=e.a,delete e.a),e.h&&(e.children=e.h,delete e.h)},P=function(e,n,t,o,r){var i=o&&!o.isRoot?o:null,s=n.isRoot;!r&&(r=0),e.h&&!e.children&&(e.children=e.h);var c=e.children,a=[],d=!1,l=null,p={};for(var u in c){var h=c[u];if(!h.unpacked){if(j(h),h.attributes)for(u=0;u<h.attributes.length;u++){var f=h.attributes[u];if(j(f),f.children)for(var m=0;m<f.children.length;m++)j(f.children[m])}h.unpacked=!0}if("tag"!==h.type||"slot"!==h.content)if(!h.raw&&d&&("text"===h.type&&"text"===d.type||"comment"===h.type&&"comment"===d.type))d.contents.push(V(h,n)),h.subs&&(d.subs=(d.subs||[]).concat(h.subs));else{var v=null;h.attributes&&(v=h.attributes.first(function(e){return-1!==I.indexOf(e.content)&&-1===O.indexOf(e.content)}));var N=!1;if(d={id:++$,type:h.type,contents:[V(h,n)],domNode:null,parent:i,instance:n,previousNode:l,subs:h.subs},h.raw&&(d.type="raw",d.isVirtual=!0),i&&i.condition&&(d.condition=i.condition),l&&(l.nextNode=d),l=d,"tag"===h.type&&h.expression&&(d.type="dynamic",d.componentChildren=h.children,d.isVirtual=!0),null===v&&"tag"===h.type&&-1!==C.indexOf(h.content)){var b=h.content;d.type=b,d.isVirtual=!0}if(i&&i.scope&&(d.scope=i.scope),null===v)if(O.length>0&&(O=[]),"component"===h.type&&(N=h.content),childNodes=!1,h.children&&(childNodes=P(h,n,t,d,r+1)),h.attributes&&(d.attributes=h.attributes.where(function(e){return-1===I.indexOf(e.content)}).select(function(e){var t={},o=!e.expression&&"("===e.content[0];return t.content=e.content,t.isAttribute=!0,t.parent=d,t.contentExpression=V(e,n),t.instance=d.instance,e.dynamic&&(t.dynamic=e.dynamic),d.scope&&(t.scope=d.scope),e.children&&(t.children=e.children.select(function(t){var r={},i="model"===e.content;return r.contentExpression=V(t,n,o,i),"dynamic"!==d.type&&"component"!==d.type||(r.propExpression=V(t,n,null,!0),t.subs&&(r.subs=t.subs)),r.content=t.content,t.subs&&!o&&(r.subs=(r.subs||[]).concat(t.subs)),r})),e.subs&&!o&&(t.subs=(t.subs||[]).concat(e.subs)),t.origin=e,t})),N){var g=!1;if(s&&(!0,g=!0,childNodes))for(var y=0;y<childNodes.length;y++)childNodes[y].rootPage=!0;var _=be(N,childNodes,d.attributes,!1,!1,{level:r,parentInstance:n});o.childInstances||(o.childInstances=[]),o.childInstances.push(_),g&&!1;var k="main";if(_.wrapper.hasVersions&&(S(_.wrapper),B(_.wrapper),k=_.wrapper&&_.wrapper.component.__version&&_.wrapper.component.__version(),!k))throw new Error("Component '"+_.wrapper.name+"' doesn't support versioning!");if(!(k in _.versions))throw new Error("Can't find version '"+k+"' for component '"+_.wrapper.name+"'!");K=a.length>0?a[a.length-1]:null,F=[];_.versions[k].each(function(e){!K||"text"!==K.type||"text"!==e.type||e.raw||K.raw?(e.nextNode=null,e.parent=i,e.previousNode=K,K&&(K.nextNode=e),K=e,F.push(e)):K.contents=K.contents.concat(e.contents)}),a=a.concat(F),l=a.length>0?a[a.length-1]:null;var x={},w=c[0].children;if(w)for(var R in w){var L=w[R];if("tag"===L.type&&"slotContent"===L.content){M=L.attributes&&L.attributes.first(function(e){return"name"===e.content&&e.children[0].content}).children[0].content;x[M]=!0}else x[0]=!0}_.wrapper._slots=x}else childNodes&&("dynamic"===d.type||"raw"===d.type?d.itemChildren=childNodes:d.children=childNodes),a.push(d);else{if(d.type=v.content,"if"===d.type&&(p={}),d.isVirtual=!0,O.push(v.content),-1!==A.indexOf(d.type)&&(d.condition=v.children?V(v.children[0],n):{},v.children&&v.children[0].subs))for(var T in d.subs=v.children[0].subs,v.children[0].subs)p[v.children[0].subs[T]]=!0;var W=!1;if("foreach"===d.type&&v.children){W=v.children[0],W.subs&&(d.subs=(d.subs||[]).concat(W.subs)),d.forExpression={};var arguments=["_component","app"].concat(E);arguments.push("return "+W.forData+";"),d.forExpression.data=Function.apply(null,arguments),d.forExpression.key=W.forKey,d.forExpression.value=W.forItem,E.push(W.forKey),E.push(W.forItem),d.scope={stack:[],data:{}}}if(d.children=P({children:[h]},n,t,d,r+1),d.childInstances&&(d.children[0].childInstances=d.childInstances,delete d.childInstances),W){var D=E.indexOf(W.forKey);D>-1&&E.splice(D,1),D=E.indexOf(W.forItem),D>-1&&E.splice(D,1)}a.push(d)}}else{!0;var H=h.attributes&&h.attributes.first(function(e){return"name"===e.content}),M=0,U=function(e){return!e.attributes};H&&(M=H.children[0].content,U=function(e){return e.attributes&&e.attributes.first(function(e){return"name"===e.content&&e.children[0].content===M})});var q=!0;if(t){if(0===M){var z=t.where(function(e){return"tag"!==e.type||"slotContent"!==e.contents[0].content});if(z.length>0){q=!1;var K=a.length>0?a[a.length-1]:null,F=[];z.each(function(e){!K||"text"!==K.type||"text"!==e.type||e.raw||K.raw||e.contents[0].func?(e.nextNode=null,e.parent=i,e.previousNode=K,K&&(K.nextNode=e),K=e,F.push(e)):K.contents=K.contents.concat(e.contents)}),a=a.concat(F)}}else{var G=t.first(function(e){return"tag"===e.type&&"slotContent"===e.contents[0].content&&U(e)});if(G){q=!1;var K=a.length>0?a[a.length-1]:null,F=[];G.children.each(function(e){!K||"text"!==K.type||"text"!==e.type||e.raw||K.raw||e.contents[0].func?(e.nextNode=null,e.parent=i,e.previousNode=K,K&&(K.nextNode=e),K=e,F.push(e)):K.contents=K.contents.concat(e.contents)}),a=a.concat(F)}}l=a.length>0?a[a.length-1]:null}if(q){var J=P(h,n,!1,i,r);K=a.length>0?a[a.length-1]:null,F=[];J.each(function(e){!K||"text"!==K.type||"text"!==e.type||e.raw||K.raw||e.contents[0].func?(e.nextNode=null,e.parent=i,e.previousNode=K,K&&(K.nextNode=e),K=e,F.push(e)):K.contents=K.contents.concat(e.contents)}),a=a.concat(F),l=a.length>0?a[a.length-1]:null}}}return a},R=function(e){if(e.attributes)for(var n=0;n<e.attributes.length;n++){var t=e.attributes[n],o=!t.expression&&"("===t.content[0];if(t.childComponent=e.component,!o){if(t.subs)for(var r in t.subs)ie(t,t.subs[r]);if(t.children)for(var i=0;i<t.children.length;i++){var s=t.children[i];if(s.subs)for(var r in s.subs)ie(t,s.subs[r])}}}},B=function(e){if(!e.isMounted){if(e.component.__beforeMount&&e.component.__beforeMount(),R(e),e.attributes)for(var n in e.attributes){var o=e.attributes[n],r="("===o.content[0],i=null;if(r){var s=o.content;i=s.substring(1,s.length-1);var c=null;o.dynamic?(o.eventExpression||(o.instance.component||(o.instance.component=S(o.instance)),o.eventExpression=V(o.dynamic,o.instance,!0)),c=o.eventExpression.func):c=o.children[0].contentExpression.func,o.listeners||(o.listeners={}),o.listeners[s]&&elm.removeEventListener(i,o.listeners[s]),o.listeners[s]=function(e){var n=[o.instance.component,t,e];if(o.scope)for(var r in o.scope.stack)n.push(o.scope.data[o.scope.stack[r]]);c.apply(null,n)},e.component.$_callbacks||(e.component.$_callbacks={}),e.component.$_callbacks[i]=o.listeners[s]}var a=null,d=null;for(var l in o.children){var p=o.children[l].propExpression;if(p.call){o.instance.component||(o.instance.component=S(o.instance),B(o.instance));var u=[o.instance.component,t];if(o.scope)for(var h in o.scope.stack)u.push(o.scope.data[o.scope.stack[h]]);d=r?e.component.$_callbacks[i]:p.func.apply(null,u),o.children[l].subs}else d=p.content;l>0?a+=d:a=d}if("model"!==o.content)if("_props"!==o.content)"true"===a?a=!0:"false"===a&&(a=!1),o.content in e.component&&(e.component[o.content]=a),e.component._props[o.content]=a;else for(var f in a){if(f in e.component&&(e.component[f]=a[f]),"("===f[0]){i=f.substring(1,f.length-1);e.component.$_callbacks||(e.component.$_callbacks={}),e.component.$_callbacks[i]=a[f]}e.component._props[f]=a[f]}else{var m=o.children[0];m.modelExpression||(m.modelExpression=V({code:m.contentExpression.code,expression:!0,model:!0},o.instance)),e.component._model=[m.modelExpression,m.propExpression],e.component.modelValue=a,e.component.$_callbacks||(e.component.$_callbacks={}),e.component.$_callbacks.model=function(e){var n=[o.instance.component,t,e];if(o.scope)for(var r in o.scope.stack)n.push(o.scope.data[o.scope.stack[r]]);m.modelExpression.func.apply(null,n)}}}e.component.__mounted&&e.component.__mounted(),e.isMounted=!0}},S=function(e){if(!e.component){var n=fe(e.name,e.params,e.__id);return e.component=n,e.isCreated=!0,Ve[e.name+"__"+e.__id]=e,e._slots&&(n._slots=e._slots),n}if(e.attributes)for(var t=0;t<e.attributes.length;t++)e.attributes[t].childComponent=e.component},L=function(e,n,o){if(e)try{var r=n.content;if(n.contentExpression.call){n.instance.component||(n.instance.component=S(n.instance));var i=[n.instance.component,t];if(n.scope)for(var s in n.scope.stack)i.push(n.scope.data[n.scope.stack[s]]);if(r=n.contentExpression.func.apply(null,i),n.latestValue&&n.latestValue!==r&&(e.removeAttribute(n.latestValue),n.listeners&&n.latestValue in n.listeners)){var a=n.latestValue.substring(1,n.latestValue.length-1);e.removeEventListener(a,n.listeners[n.latestValue])}n.latestValue=r}if("#"===r[0])return void(n.instance.component._refs[r.substring(1)]=e);if("("===r[0]){if(v&&!o)return;a=r.substring(1,r.length-1);var d=null;n.dynamic?(n.eventExpression||(n.instance.component||(n.instance.component=S(n.instance)),n.eventExpression=V(n.dynamic,n.instance,!0)),d=n.eventExpression.func):d=n.children[0].contentExpression.func,n.listeners||(n.listeners={}),n.listeners[r]&&e.removeEventListener(a,n.listeners[r]),n.listeners[r]=function(e){var o=[n.instance.component,t,e];if(n.scope)for(var r in n.scope.stack)o.push(n.scope.data[n.scope.stack[r]]);d.apply(null,o)},e.addEventListener(a,n.listeners[r])}else{if(o&&"model"!==r)return;if(n.subs&&!n.subscribed){for(var l in n.subs)ie(n,n.subs[l]);n.subscribed=!0}var p=!1,u=!0;r in c&&(p=!0);var h=[];for(var f in n.children){if(n.children[f].subs&&!n.children[f].subscribed){for(var l in n.children[f].subs)ie(n,n.children[f].subs[l]);n.children[f].subscribed=!0}var m=n.children[f].contentExpression;if(m.call){n.instance.component||(n.instance.component=S(n.instance));i=[n.instance.component,t];if(n.scope)for(var s in n.scope.stack)i.push(n.scope.data[n.scope.stack[s]]);u=m.func.apply(null,i),h.push(u)}else h.push(m.content)}if(p)return void(u?e.setAttribute(r,r):e.removeAttribute(r));var N="model"===r,b=h.join("");if(N){if(v&&!o)return;b=h[0];var g=n.instance.component._model;g&&(b=g[1].func.apply(null,[g[1].instance.component,t]));var y="checkbox"===e.getAttribute("type"),_="radio"===e.getAttribute("type"),k="SELECT"===e.tagName,x=k&&e.multiple,w=y||_;if(w||x||(e.value=b),_){var E=e.checked;e.value!==b&&E?(e.removeAttribute("checked"),e.checked=!1):e.value!==b||E||(e.setAttribute("checked","checked"),e.checked=!0)}a=w||k?"change":"input";if(n.listeners||(n.listeners={}),!n.valueExpression&&n.children.length>0){n.instance.component||(n.instance.component=S(n.instance));i=[n.instance.component,t];var C=[];if(n.scope)for(var s in n.scope.stack)C.push(n.scope.data[n.scope.stack[s]]);n.valueExpression=V({code:n.children[0].contentExpression.code,expression:!0,setter:!0,isChecked:y,isMultiple:x,scope:n.scope},n.instance),n.modelValueExpression=V({code:n.children[0].contentExpression.code,expression:!0},n.instance),n.modelSetValueExpression=V({code:n.children[0].contentExpression.code,expression:!0,model:!0},n.instance),g&&!g[2]&&(g[2]=n.modelSetValueExpression);d=n.valueExpression.func;var I=n.modelValueExpression.func,A=g?I.apply(null,i):b;w&&Array.isArray(A)?-1!==A.indexOf(n.parent.domNode.value)?(n.parent.domNode.setAttribute("checked","checked"),n.parent.domNode.checked=!0):(n.parent.domNode.removeAttribute("checked"),n.parent.domNode.checked=!1):(n.modelSetValueExpression.func.apply(null,i.concat([b]).concat(C)),w&&(b?(n.parent.domNode.setAttribute("checked","checked"),n.parent.domNode.checked=!0):(n.parent.domNode.removeAttribute("checked"),n.parent.domNode.checked=!1))),n.listeners[a]=function(e){if(d.apply(null,i.concat([e]).concat(C)),g){var n=I.apply(null,i.concat([e]).concat(C));g[0].func.apply(null,[g[0].instance.component,t,n])}}}else{I=n.modelValueExpression.func,A=g?I.apply(null,i):b;if(w&&Array.isArray(A))-1!==A.indexOf(n.parent.domNode.value)?(n.parent.domNode.setAttribute("checked","checked"),n.parent.domNode.checked=!0):(n.parent.domNode.removeAttribute("checked"),n.parent.domNode.checked=!1);else if(_){E=n.parent.domNode.checked;n.parent.domNode.value!==b&&E?(n.parent.domNode.removeAttribute("checked"),n.parent.domNode.checked=!1):n.parent.domNode.value!==b||E||(n.parent.domNode.setAttribute("checked","checked"),n.parent.domNode.checked=!0),n.modelSetValueExpression.func.apply(null,i.concat([b]).concat(C))}else n.modelSetValueExpression.func.apply(null,i.concat([b]).concat(C)),w&&(b?(n.parent.domNode.setAttribute("checked","checked"),n.parent.domNode.checked=!0):(n.parent.domNode.removeAttribute("checked"),n.parent.domNode.checked=!1))}e.removeEventListener(a,n.listeners[a]),e.addEventListener(a,n.listeners[a])}else null===h[0]?e.removeAttribute(r):e.getAttribute(r)!==b&&e.setAttribute(r,b)}}catch(e){console.error(e),console.log(n.content)}},T=function(e){for(var n=e,t=!0,o=!1,r=!1;!n.domNode||t;)if(t=!1,null!==n.previousNode){if(n=n.previousNode,o=!1,n.isVirtual){if(n===r)throw new Error("Can't find the node before current!");r=n;for(var i=n;null!==i&&!i.domNode;)i=i.isVirtual&&i.children?i.children[i.children.length-1]:null;i&&(n=i)}}else{if(null===n.parent)return null;n=n.parent,o=!0}return{itsParent:o,node:n}},$=0,W=function(e,n,o,r){if(!r&&(n.isVirtual||"text"===n.type)){for(var i=n;i.parent&&i.parent.isVirtual;)i=i.parent;for(var c=T(n),d=(c&&c.itsParent?c.node.domNode:c&&c.node.domNode.parentNode)||e,l=i;l.previousNode&&(l.previousNode.isVirtual||"text"===l.previousNode.type);)l=l.previousNode;for(var p=i;p.nextNode&&(p.nextNode.isVirtual||"text"===p.nextNode.type);)p=p.nextNode;if(l!==i||p!==i){for(var f=l,m=!0;m;)W(d,f,!0,!0),f.isVirtual&&f===n.parent&&W(d,n,!0,!0),m=f!==p,f=f.nextNode;return}}if(n.renderIteration!==Oe){if(n.renderIteration=Oe,o){var N=n.parent&&n.parent.condition,b=N&&N.value;if(N&&!b)return void F([n])}if(n.isVirtual||!n.condition||n.condition.value){n.instance.component||(n.instance.component=S(n.instance)),n.instance.isMounted||B(n.instance);var g=[];for(var y in n.contents){var _=n.contents[y];if(_.call){var k=[_.instance.component,t];if(n.scope)for(var x in n.scope.stack)k.push(n.scope.data[n.scope.stack[x]]);g.push(_.func.apply(null,k))}else g.push(_.content)}var w=g.join(""),E=!1,V=!1;if(n.skipIteration){n.skipIteration=!1;for(var C=n;C.isVirtual;)C=C.parent;E=C.domNode;var I=H.first(function(e,n){return e===E},!0);if(I&&I[0].parentNode&&(M[I[1]]=!0),n.refreshAttributes&&n.attributes)for(var A in n.refreshAttributes=!1,n.attributes)L(E,n.attributes[A])}else switch(n.type){case"text":if(e.doctype){E=e.doctype;break}var O=!1,j=T(n);if(o&&null==j)return;if(!O)if(j&&"text"==j.node.type)j.node.domNode.nodeValue+=w,null!==n.domNode&&(n.domNode.parentNode&&n.domNode.parentNode.removeChild(n.domNode),n.domNode=null);else if(null!==n.domNode&&n.domNode.parentNode===e)n.domNode.nodeValue!==w&&(n.domNode.nodeValue=w),E=n.domNode;else{E=document.createTextNode(w);var P=j.node.domNode.nextSibling;j.itsParent||null===P?j.itsParent?j.node.domNode.childNodes.length>0?j.node.domNode.insertBefore(E,j.node.domNode.childNodes[0]):j.node.domNode.appendChild(E):(j.node.domNode.parentNode||e).appendChild(E):P.parentNode.insertBefore(E,P),n.domNode=E}break;case"tag":if(e.documentElement){E=e.documentElement,n.domNode=E,M[0]=!0,M[1]=!0;break}if(!v&&w in a){var R=E=document.createElement(w);if(n.domNode=E,z(R,n,n.children,V,r),n.attributes)for(var A in n.attributes)L(R,n.attributes[A]);var $=H.first(function(e,n){return!(n in M)&&e.isEqualNode(R)},!0);if($){M[$[1]]=!0,n.domNode=$[0];j=T(n),P=j.node.domNode.nextSibling;j.itsParent||null===P?j.itsParent?j.node.domNode.appendChild($[0]):j.node.domNode.parentNode.appendChild($[0]):P.parentNode.insertBefore($[0],P);break}if(!$&&($=u.first(function(e){return e.isEqualNode(R)}),$)){n.domNode=$;j=T(n),P=j.node.domNode.nextSibling;j.itsParent||null===P?j.itsParent?j.node.domNode.appendChild($):j.node.domNode.parentNode.appendChild($):P.parentNode.insertBefore($,P);break}}if(!v&&"head"===w){var D=H.first(function(e){return e.nodeName.toLowerCase()===w},!0);E=D[0],M[D[1]]=!0,n.domNode=E;break}var G=U?H.first(function(e,n){return e.nodeName.toLowerCase()===w&&!(n in M)},!0):null;if(G&&G[0].parentNode){if(M[G[1]]=!0,q==G[1]){E=G[0],n.domNode=E;break}G[1]in M||G[0].parentNode.removeChild(G[0])}var J=w in h||e.isSvg;if(E=J?document.createElementNS("http://www.w3.org/2000/svg",w):document.createElement(w),J&&(E.isSvg=!0),null!==n.domNode&&n.domNode.parentNode)n.domNode.parentNode.replaceChild(E,n.domNode),n.children&&F(n.children);else{j=T(n);if(null==j)return;P=j.node.domNode.nextSibling;j.itsParent||null===P?j.itsParent?j.node.domNode.childNodes.length>0?j.node.domNode.insertBefore(E,j.node.domNode.childNodes[0]):j.node.domNode.appendChild(E):(j.node.domNode.parentNode||e).appendChild(E):P.parentNode.insertBefore(E,P)}if(n.domNode=E,w in a&&u.push(E),n.attributes)for(var A in n.attributes)L(E,n.attributes[A]);break;case"comment":if(E=document.createComment(w),null!==n.domNode)n.domNode.parentNode.replaceChild(E,n.domNode);else{j=T(n);if(null==j)return;P=j.node.domNode.nextSibling;j.itsParent||null===P?j.itsParent?j.node.domNode.childNodes.length>0?j.node.domNode.insertBefore(E,j.node.domNode.childNodes[0]):j.node.domNode.appendChild(E):j.node.domNode.parentNode.appendChild(E):P.parentNode.insertBefore(E,P)}n.domNode=E;break;case"if":usedSubscriptions={},n.instance.component||(n.instance.component=S(n.instance));k=[n.instance.component,t];if(n.scope)for(var x in n.scope.stack)k.push(n.scope.data[n.scope.stack[x]]);var X=!!n.condition.func.apply(null,k);if(void 0!==n.condition.value&&X===n.condition.value&&"template"!==w){if(n.children)for(y=0;y<n.children.length;y++)n.children[y].domNode&&(n.children[y].domNode.usedByRenderer=!0);return}n.condition.value=X,E=e,n.parentDomNode=e,n.condition.previousValue=n.condition.value,n.topRealPreviousNode=n.parent&&n.parent.topRealPreviousNode||n.previousNode,V=!0;break;case"else-if":n.instance.component||(n.instance.component=S(n.instance));k=[n.instance.component,t];if(n.scope)for(var x in n.scope.stack)k.push(n.scope.data[n.scope.stack[x]]);X=!n.previousNode.condition.value&&!!n.condition.func.apply(null,k);if(n.condition.previousValue=n.previousNode.condition.value||X,void 0!==n.condition.value&&X===n.condition.value&&"template"!==w){if(n.children)for(y=0;y<n.children.length;y++)n.children[y].domNode&&(n.children[y].domNode.usedByRenderer=!0);return}n.condition.value=X,E=e,n.parentDomNode=e,n.topRealPreviousNode=n.parent&&n.parent.topRealPreviousNode||n.previousNode,V=!0;break;case"else":X=!n.previousNode.condition.previousValue;if(void 0!==n.condition.value&&X===n.condition.value&&"template"!==w){if(n.children)for(y=0;y<n.children.length;y++)n.children[y].domNode&&(n.children[y].domNode.usedByRenderer=!0);return}n.condition.value=X,E=e,n.parentDomNode=e,n.topRealPreviousNode=n.parent&&n.parent.topRealPreviousNode||n.previousNode,V=!0;break;case"template":E=e,V=!0;break;case"foreach":if(E=e,V=!0,E){n.itemChildren||(n.itemChildren=n.children),n.instance.component||(n.instance.component=S(n.instance));k=[n.instance.component,t];if(n.scope)for(var x in n.scope.stack)k.push(n.scope.data[n.scope.stack[x]]);var Z=n.forExpression.data.apply(null,k),ee=null,ne=Array.isArray(Z),te={},oe={},re=[];for(var x in Z){var se=ne?+x:x,ce=!1;if(n.children)for(y=0;y<n.children.length;y++)if(!(x in te||y in oe)&&n.children[y].foreachData===Z[x]){te[x]=!0,n.children[y].previousNode=ee,ee&&(ee.nextNode=n.children[y]),ee=n.children[y],n.children[y].scope.data[n.forExpression.key]=se,re.push(n.children[y]),oe[y]=!0,ce=!0;break}if(!ce){var ae={type:"template",isVirtual:!0,parent:n,previousNode:ee,instance:Object.assign({},n.instance),domNode:null,scope:n.scope,foreachData:Z[x],foreachKey:se};ae.scope={parentScope:n.scope,data:Object.assign({},n.scope.data),stack:n.scope.stack.slice()},ee&&(ee.nextNode=ae),ee=ae,ae.scope.stack.push(n.forExpression.key),ae.scope.stack.push(n.forExpression.value),ae.scope.data[n.forExpression.key]=se,ae.scope.data[n.forExpression.value]=Z[x],Y(ae,n.itemChildren),re.push(ae)}}if(null!=n.children)if(re.length>0)for(y=n.children.length-1;y>=0;y--)y in oe||F([n.children[y]],!0);else F(n.children,!0);re.length>0?n.children=re:n.children=null}break;case"dynamic":if(E=e,V=!0,n.latestVal===w){if(n.children)for(y=0;y<n.children.length;y++)n.children[y].domNode&&(n.children[y].domNode.usedByRenderer=!0);return}F(n.children),n.children=null;ae={contents:n.contents,attributes:n.attributes,parent:n,previousNode:null,scope:n.scope,instance:n.instance,domNode:null};if(n.itemChildren&&Q(ae,n.itemChildren),w in s)ae.type="tag",ae.root=n.root;else{var de=be(w,ae.children,n.attributes,!1,!1,n.instance);S(de.wrapper),B(de.wrapper),Ee(de.root),ae.type="template",ae.isVirtual=!0,ae.children=de.versions.main,ae.children.each(function(e){e.parent=ae})}n.children=[ae],n.latestVal=w;break;case"raw":if(E=e,V=!0,n.latestHtml===w){if(n.rawNodes)for(y=0;y<n.rawNodes.length;y++)n.rawNodes[y].domNode.usedByRenderer=!0;if(!n.subscribed&&n.subs){for(var le in n.subs)ie(n,n.subs[le]);n.subscribed=!0}return}n.latestHtml=w,n.rawNodes&&F(n.rawNodes),n.children=null,n.rawNodes=null;var pe=K(n);if(pe){var ue=document.createElement(pe.domNode.nodeName);if(ue.innerHTML=w,ue.childNodes.length>0){var he=0,fe=T(n);fe.itsParent||"text"!==fe.node.type||3!==ue.childNodes[0].nodeType||(fe.node.domNode.nodeValue+=ue.childNodes[0].nodeValue,he=1);for(var me=[];he<ue.childNodes.length;he++)me.push({domNode:ue.childNodes[he]});P=fe.node.domNode.nextSibling;if(me.length>0){for(y=0;y<me.length;y++)!fe.itsParent&&P?P.parentNode.insertBefore(me[y].domNode,P):fe.itsParent?fe.node.domNode.appendChild(me[y].domNode):fe.node.domNode.parentNode.appendChild(me[y].domNode);var ve=me[me.length-1];n.children=[{type:3===ve.domNode.nodeType?"text":"tag",parent:n,previousNode:null,scope:n.scope,instance:n.instance,domNode:ve.domNode}],n.rawNodes=me}}}if(n.rawNodes)for(y=0;y<n.rawNodes.length;y++)n.rawNodes[y].domNode.usedByRenderer=!0;if(n.subs&&!n.subscribed){for(var le in n.subs)ie(n,n.subs[le]);n.subscribed=!0}return;default:throw new Error("Node type '"+n.type+"' is not implemented.")}if(!n.isVirtual&&E&&n.root&&(n.instance.component._element=E),E&&(E.usedByRenderer=!0),n.subs&&!n.subscribed){for(var le in n.subs)ie(n,n.subs[le]);n.subscribed=!0}E&&z(E,n,n.children,V,r)}}},D=null,H=[],M={},U=!1,q=0,z=function(e,n,t,o,r){var i=D,s=H,c=M;if(D=e,e.childNodes&&!n.isVirtual)for(var a=0;a<e.childNodes.length;a++)"usedByRenderer"in e.childNodes[a]&&(e.childNodes[a].usedByRenderer=!1);for(var a in U&&e!==i&&(H=Array.prototype.slice.call(D.childNodes),M={}),t){var d=H.first(function(e,n){return e===t[a].domNode},!0);d&&d[0].parentNode&&(M[d[1]]=!0)}for(var a in t)q=a,t[a].childInstances&&Ee(t[a]),W(e,t[a],o,r);if(e.childNodes&&!n.isVirtual)for(a=e.childNodes.length-1;a>=0;a--)e.childNodes[a].usedByRenderer||"usedByRenderer"in e.childNodes[a]&&e.removeChild(e.childNodes[a]);D=i,H=s,M=c},K=function(e){return e.parent?e.parent.domNode?e.parent:K(e.parent):null},F=function(e,n){for(var t in e){if(e[t].children&&F(e[t].children,n),e[t].domNode&&(e[t].domNode.parentNode&&e[t].domNode.parentNode.removeChild(e[t].domNode),e[t].domNode=null),A.includes(e[t].type)&&delete e[t].condition.value,e[t].latestVal&&delete e[t].latestVal,e[t].skipIteration&&(e[t].skipIteration=!1),e[t].origin)for(var o in e[t].origin)e[t].origin[o]&&(e[t].origin[o].skipIteration=!1,e[t].origin[o].domNode=null,e[t].origin[o]=null);n&&e[t].subs&&(e[t].mute=!0)}},G={},J=!1,Y=function(e,n){G={},J=!0,Q(e,n),J=!1},Q=function(e,n){var t=null,o=n.select(function(n){var o=X(e,n);return o.parent=e,o.previousNode=t,t=o,o.previousNode&&(o.previousNode.nextNode=o),o});e.itemChildren?e.itemChildren=o:e.children=o},X=function(e,n){var t=Object.assign({},n);return n.cloned=!0,delete t.cloned,delete t.subscribed,t.nextNode=null,t.previousNode=null,t.domNode=null,t.scope=e.scope||t.scope,n.condition&&(A.includes(n.type)?t.condition=Object.assign({},n.condition):t.condition=e.condition),J&&(t.instance.component||(t.instance.__id in G?t.instance=G[t.instance.__id]:(t.instance=Object.assign({},n.instance),G[t.instance.__id]=t.instance,t.instance.__id=++Z,G[t.instance.__id]=t.instance),t.instance.attributes&&(t.instance.attributes=t.instance.attributes.select(function(e){var n=Object.assign({},e);return n.scope=t.scope||n.scope,n.origin=Object.assign({},e.origin),delete n.childComponent,n}))),n.childInstances&&(t.childInstances=n.childInstances.select(function(e){if(!e.wrapper.component){var n=Object.assign({},e);return e.wrapper.__id in G?n.wrapper=G[e.wrapper.__id]:(n.wrapper=Object.assign({},e.wrapper),G[n.wrapper.__id]=n.wrapper,n.wrapper.__id=++Z,G[n.wrapper.__id]=n.wrapper,n.wrapper.attributes&&(n.wrapper.attributes=e.wrapper.attributes.select(function(e){var n=Object.assign({},e);return n.scope=t.scope||n.scope,n}))),n}return e})),t.contents=t.contents.select(function(e){var n=Object.assign({},e);return n.call&&n.instance.__id in G&&(n.instance=G[n.instance.__id]),n})),t.attributes&&(t.attributes=t.attributes.select(function(e){var o=Object.assign({},e);return o.parent=t,e.cloned=!0,delete o.cloned,delete o.subscribed,J&&!o.instance.component&&(o.instance.__id in G?o.instance=G[o.instance.__id]:(o.instance=Object.assign({},n.instance),G[o.instance.__id]=o.instance,o.instance.__id=++Z,G[o.instance.__id]=o.instance,o.instance.attributes=o.instance.attributes.select(function(e){var n=Object.assign({},e);return n.scope=o.scope||n.scope,n}))),o.scope=t.scope||o.scope,e.children&&(e.children=e.children.select(function(e){var n=Object.assign({},e);return n.parent=t,e.cloned=!0,delete n.cloned,delete n.subscribed,n})),o})),(n.children||n.itemChildren)&&Q(t,n.children||n.itemChildren),t},Z=0,ee=function(e,n){return"__id"in e||Object.defineProperty(e,"__id",{enumerable:!1,writable:!1,value:n||++Z}),e.__id},ne={},te={},oe={},re={},ie=function(e,n){var t=e.isAttribute,o=t?e.parent.instance:e.instance,r=ee(o);r in te||(te[r]={});for(var i=n.split("."),s=i[0],c=[],a=1;a<i.length;a++){var d=i[a].split("[");d.length>1&&c.push(s+"."+d[0]),s=s+"."+i[a],c.push(s)}for(a=0;a<c.length;a++){var l=c[a];if(l in te[r]||(te[r][l]=[]),te[r][l].push(e),l in re){var p=re[l],u=p.instance,h=p.subs,f=ee(u);for(var m in f in te||(te[f]={}),h){var v=h[m];v in te[f]||(te[f][v]=[]),te[f][v].push(e)}}}},se=function(){var e=ne;for(var n in ne={},Oe++,e)for(var o in e[n])try{var r=e[n][o];if(r.mute)continue;if(r.isAttribute){var i="dynamic"===r.parent.type?r.parent.children&&r.parent.children.length>0&&r.parent.children[0].domNode:r.parent.domNode;if(i)L(i,r);else if("component"===r.parent.type&&r.childComponent){var s=[r.instance.component,t];if(r.scope)for(var c in r.scope.stack)s.push(r.scope.data[r.scope.stack[c]]);currentValue=null;for(var a=0;a<r.children.length;a++){var d=r.children[a].propExpression.call?r.children[a].propExpression.func.apply(null,s):r.children[a].propExpression.content;currentValue=0===a?d:currentValue+d}"model"===r.content?r.childComponent._model[2]?r.childComponent._model[2].func.apply(null,[r.childComponent,t,currentValue]):r.childComponent.modelValue=currentValue:r.childComponent[r.content]=currentValue}}else if(r.isVirtual)W(r.parentDomNode,r);else{var l=r.domNode&&r.domNode.parentNode;if(!l){var p=T(r);l=p&&p.node.domNode&&p.node.domNode.parentNode}l&&W(l,r)}}catch(e){console.error(e)}Object.keys(ne).length>0&&se()},ce=function(e){for(var n in e.subs){var t=e.subs[n],o=t.id;o in te&&t.path in te[o]&&(ne[o+"_"+t.path]=te[o][t.path],setTimeout(function(){se()},0))}};this.notify=function(e,n){if(Array.isArray(e)){var t=Object.getPrototypeOf(e);t.deps&&ce(t.deps)}};var ae=function(e,n){var t=Object.getPrototypeOf(e);if(!("deps"in t)){var o={};return Object.defineProperty(o,"deps",{enumerable:!1,writable:!1,value:n}),Object.setPrototypeOf(o,t),Object.setPrototypeOf(e,o),e}for(var r in n)for(var i in r in e.deps||(e.deps[r]={}),n[r])e.deps[r][i]=n[r][i]},de=["this._element","this._refs","this._props"],le=function(e){var n=arguments.length>1?arguments[1]:e,t=arguments.length>2?arguments[2]:"this",o=arguments.length>3?arguments[3]:{subs:{}};if(-1===de.indexOf(t)){if(Array.isArray(e)){ae(e,o);for(var r=0;r<e.length;r++)null!==e[r]&&"object"==typeof e[r]&&le(e[r],n,t+"[key]")}else{var i=Object.keys(e);for(r=0;r<i.length;r++)ue(n,t+"."+i[r],e,i[r]),ue(n,t+"[key]",e,i[r])}return e}},pe=null,ue=function(e,n,t,o){pe=null;var r=null,i=t[o],s=!1
;if(pe?r=pe:(r={subs:{}},s=!0),null!==i&&"object"==typeof i&&le(i,e,n,r),"function"!=typeof i){var c=ee(e);r.subs[c+n]={instance:e,id:c,path:n},s&&Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:function(){return pe=r,i},set:function(t){t!==i&&(ce(r),i=t,null!==i&&"object"==typeof i&&le(i,e,n,r))}})}},he={},fe=function(e,o,r){var i=t.components[e];if(!i)return null;var s=i.dependencies,c=i.service;if(c&&e in he)return he[e];if(!s){var a=new(n(e));return i.init&&a.__init(),ee(a,r),le(a),c&&(he[e]=a),a}var arguments=[null];for(var d in s){var l=s[d],p=null;p=o&&l.argName in o?o[l.argName]:l.default?l.default:l.null?null:l.builtIn?"string"===l.name?"":0:fe(l.name),arguments.push(p)}a=i.init?new(n(e)):new(n(e).bind.apply(n(e),arguments));return i.init&&(arguments.shift(),a.__init.apply(a,arguments)),ee(a,r),le(a),c&&(he[e]=a),a},me=function(e,n){var t=e.length,o=n.length;if(t!=o){F(n);for(var r=0;r<t;r++)e[r].skipIteration&&(e[r].skipIteration=!1,e[r].domNode=null,e[r].children&&F(e[r].children,!0));return!1}var i=!0;for(r=0;r<t;r++)if(r<o){var s=!e[r].rootPage,c=!1,a=e[r].contents&&e[r].contents.select(function(e){return e.content||e.code}).join(),d=n[r].contents&&n[r].contents.select(function(e){return e.content||e.code}).join();e[r].instance.name!=n[r].instance.name&&(s=!1),a!=d&&(s=!1);var l=e[r].attributes&&e[r].attributes.select(function(e){return(e.content||"")+(e.children&&";"+e.children.select(function(e){return e.contentExpression.content||e.contentExpression.code||""}).join(";")||"")}).join(";"),p=n[r].attributes&&n[r].attributes.select(function(e){return(e.content||"")+(e.children&&";"+e.children.select(function(e){return e.contentExpression.content||e.contentExpression.code||""}).join(";")||"")}).join(";");if(l!=p&&(s=!1),s||"dynamic"===e[r].type&&"dynamic"===n[r].type){if(s=!0,c=e[r].contents&&e[r].contents.first(function(e){return e.code}),e[r].condition&&(e[r].condition=n[r].condition),e[r].domNode=n[r].domNode,e[r].domNode=n[r].domNode,e[r].instance.__id===n[r].instance.__id&&(e[r].subscribed=n[r].subscribed,e[r].subscribed&&e[r].instance.__id in oe))for(var u in oe[e[r].instance.__id])for(var h=0;h<oe[e[r].instance.__id][u].length;h++)oe[e[r].instance.__id][u][h]===n[r]&&(oe[e[r].instance.__id][u][h]=e[r]);e[r].skipIteration=!e[r].isVirtual&&!!n[r].domNode&&!c,e[r].skipIteration&&(n[r].origin||(n[r].origin={}),n[r].origin[e[r].id]=e[r],e[r].refreshAttributes=e[r].attributes&&e[r].attributes.first(function(e){return e.children&&e.children.first(function(e){return e.contentExpression.code})}),e[r].refreshAttributes&&e[r].attributes.each(function(e,t){e.latestValue=n[r].attributes[t].latestValue,e.listeners=n[r].attributes[t].listeners})),n[r].rawNodes&&(e[r].rawNodes=n[r].rawNodes,e[r].latestHtml=n[r].latestHtml);var f=!0;if("dynamic"===e[r].type&&e[r].instance===n[r].instance&&n[r].latestVal){var m=function(e){for(var n=0;n<e.length;n++)if(!e[n].instance.rooted||e[n].children&&!m(e[n].children))return!1;return!0};f=m(n[r].children),f&&e[r].instance.rooted&&(e[r].children=n[r].children)}f&&n[r].children&&e[r].children&&(s=me(e[r].children,n[r].children),s&&e[r].instance.rooted&&(e[r].latestVal=n[r].latestVal))}else n[r].domNode&&n[r].domNode.parentNode?n[r].domNode.parentNode.removeChild(n[r].domNode):n[r].isVirtual&&(e[r].previousNode&&"text"===e[r].previousNode.type&&e[r].previousNode.skipIteration&&(e[r].previousNode.skipIteration=!1,F([e[r].previousNode])),F(n[r].children)),e[r].children&&F(e[r].children),n[r].rawNodes&&(e[r].rawNodes=n[r].rawNodes,e[r].latestHtml=n[r].latestHtml);i=i&&s}return i},ve=null,Ne=function(e){return e?e.select(function(e){return Object.assign({},e)}):null},be=function(e,n,o,r,i,s){if(!(e in t.components))throw new Error("Component "+e+" doesn't exist.");var c=null,a=null,d=!1,l=s.parentInstance&&(s.parentInstance.rooted||s.parentInstance.isRoot&&0===s.level);if(l){d=(0===s.level?"":s.parentInstance.name+"_")+e;var p=ye.components.first(function(e){return e.instanceWrapper.key===d},!0);p&&(ye.components.splice(p[1],1),c=p[0].build,a=p[0].instanceWrapper,a.isMounted=!1,a.attributes=Ne(o),a.params=r,a.component&&oe[a.component.__id]&&(te[a.component.__id]=oe[a.component.__id]))}var u=ve;ve=e;var h=t.components[e];a=a||{component:null,name:e,isMounted:!1,isCreated:!1,params:r,hasVersions:h.hasVersions,isRoot:i,rooted:s.parentInstance&&s.parentInstance.rooted||!i&&0===s.level&&s.parentInstance&&s.parentInstance.isRoot&&e,attributes:Ne(o),__id:++Z},l&&!a.key&&(a.key=d);var f={isRoot:!0},m={root:f,versions:{},wrapper:a};if(h.hasVersions)for(var v in h.versions)m.versions[v]=P(h.versions[v],a,n,f,s.level),c&&me(m.versions[v],c.versions[v]);else m.versions.main=P(h.nodes,a,n,f,s.level),c&&me(m.versions.main,c.versions.main);for(var v in m.versions)for(var N=0;N<m.versions[v].length;N++)m.versions[v][N].root=!0;return ve=u,l?ge.components.push({name:e,build:m,instanceWrapper:a}):ge.watchList.push(a),m},ge={name:null,nodes:null,components:[],watchList:[]},ye={name:null,nodes:null,components:[],watchList:[]},_e=function(e,n){if(e.children)for(var t in e.children)e.children[t].domNode?n.push(e.children[t]):e.children[t].isVirtual&&_e(e.children[t],n)},ke=/^\s+|\s+$/,xe=function(e,n){var t=e.domNode.nodeType===n.nodeType;if(t){if(3===e.domNode.nodeType||8==e.domNode.nodeType)t=e.domNode.nodeValue.replace(ke,"")==n.nodeValue.replace(ke,""),t&&(e.domNode=n);else if(1===e.domNode.nodeType&&(t=e.domNode.nodeName==n.nodeName,t)){var o=e.domNode;e.domNode=n,!e.isVirtual&&n&&e.root&&e.instance&&e.instance.component&&(e.instance.component._element=n);var r=0,i=0,s=n.childNodes.length,c=e.children?e.children.length:0;e.children&&e.children.length>0&&(e.children[c-1].domNode&&3===e.children[c-1].domNode.nodeType&&(0==n.childNodes.length||3!==n.childNodes[s-1].nodeType)&&/^\s*$/.test(e.children[c-1].domNode.nodeValue)&&n.appendChild(e.children[c-1].domNode),e.children[0].domNode&&3===e.children[0].domNode.nodeType&&3!==n.childNodes[0].nodeType&&/^\s*$/.test(e.children[0].domNode.nodeValue)&&n.insertBefore(e.children[0].domNode,n.childNodes[0]),c=e.children.length,s=n.childNodes.length);for(var a=[],d=[],l=0;l<c;l++)e.children[l].rawNodes?d=d.concat(e.children[l].rawNodes):e.children[l].isVirtual?_e(e.children[l],d):d.push(e.children[l]);var p=d.length;for(l=0;l+i<s;l++){for(;l+r<p&&!d[l+r].domNode;)r++;if(l+r<p)if(d[l+r].type){var u=xe(d[l+r],n.childNodes[l+i]);if(!u){for(var h=!1,f=l+i+1;f<s;f++)if(h=xe(d[l+r],n.childNodes[f]),h){for(var m=l+i;m<f;m++)a.push(m);i+=f-(l+i);break}if(h)continue;e.domNode!==d[l+r].domNode.parentNode?(e.domNode.childNodes.length>l+i?e.domNode.replaceChild(d[l+r].domNode,e.domNode.childNodes[l+i]):e.domNode.appendChild(d[l+r].domNode),xe(d[l+r],n.childNodes[l+i])):a.push(l)}}else d[l+r].domNode=n.childNodes[l+i];else a.push(l+i)}for(l=s;l+r<p;l++)d[l+r].domNode&&e.domNode.appendChild(d[l+r].domNode);if(a.length>0)for(var v=a.length-1;v>=0;v--){var N=a[v];["BODY","HEAD"].includes(n.childNodes[N].nodeName)?n.replaceChild(e.children.first(function(e){return e.domNode.nodeName&&e.domNode.nodeName===n.childNodes[N].nodeName}).domNode,n.childNodes[N]):n.removeChild(n.childNodes[N])}if(s=n.childNodes.length,s>p)for(v=s-1;v>=p;v--)n.removeChild(n.childNodes[v]);if(p>s)for(v=s;v<p;v++)d[v].domNode&&!d[v].type&&n.appendChild(d[v].domNode);if(e.attributes)for(var b in e.attributes)L(e.domNode,e.attributes[b],!0);for(var g=o.getAttributeNames(),y=(e.domNode.getAttributeNames(),0);y<g.length;y++){var _=g[y],k=o.getAttribute(_);e.domNode.getAttribute(_)!==k&&e.domNode.setAttribute(_,k)}}e.domNode&&(e.domNode.usedByRenderer=!0)}return t},we=!1,Ee=function(e){if(e.childInstances)for(var n in e.childInstances)S(e.childInstances[n].wrapper),B(e.childInstances[n].wrapper),e.childInstances[n].root.childInstances&&Ee(e.childInstances[n].root)},Ve={},Ce=!1,Ie=!1,Ae=!1,Oe=0;this.runComponent=function(e,n,o){g?t.render(e,o,!1,n):t.start(function(){t.runComponent(e,n,o)})},this.render=function(n,r,s,c){if(!n)throw new Error("Component name is required.");if(!(n in t.components))throw new Error("Component "+n+" doesn't exist.");if(t.components[n].lazyLoad){var a=t.components[n].lazyLoad,d=VIEWI_PATH+"/"+a+".group.json"+VIEWI_VERSION,l=!1;i.get(d).then(function(e){for(var o in e)delete t.components[o].lazyLoad,t.components[o]=Object.assign(t.components[o],e[o]),o===n&&(l=!0);l?t.render(n,r,s,c):console.error('Component "'+n+'" was not found in the group: '+d)},function(){console.error("Failed to lazy load the component in the group: "+d)})}else{if(Ve={},!s&&e[n]&&e[n]._beforeStart){var p=e[n]._beforeStart;if(p.length>0){var u=p.length-1,h=p[u],f=fe(h),m=function(){var e=!(arguments.length>0)||arguments[0];e&&(u>0?(u--,h=p[u],f=fe(h),f.run(m)):t.render(n,r,!0,c))};return void f.run(m)}}Ce&&(Ie=!0);var N=function(){for(var e=0;e<ye.components.length;e++){var n=ye.components[e];n.instanceWrapper&&n.instanceWrapper.component&&n.instanceWrapper.component.__destroy&&n.instanceWrapper.component.__destroy()}for(e=0;e<ye.watchList.length;e++){var t=ye.watchList[e];t.component&&t.component.__destroy&&t.component.__destroy()}};Ce=!0,!1,o||(oe=te,te={}),ne={},ve=null,Ie&&N(),ye=ge,ge={},ge.name=n,ge.components=[],ge.watchList=[];var g=be(n,null,null,r,!0,{level:0}),y=g.versions.main;ge.nodes=y,U=!v;var _=c?document.querySelector(c):document;if(!_)throw new Error("Can't resolve target DOM node.");var k=v?c?document.createElement(_.nodeName):{documentElement:document.createElement("html"),doctype:{childNodes:[]},childNodes:v?[]:_.childNodes}:_;if(S(g.wrapper),Ae)return N(),void(Ae=!1);if(B(g.wrapper),Ae)return N(),void(Ae=!1);if(Ee(g.root),Ae)return N(),void(Ae=!1);N(),Oe++;for(var x=0;x<y.length;x++)y[x].parent={domNode:k};z(k,{},y,!1);var w=c?{children:y,domNode:_}:y[1];for(var E in w||"dynamic"!==y[0].type||(w=y[0].children[0].children[1]),v&&xe(w,_.documentElement||_),Ve)Ve[E].component.__rendered&&Ve[E].component.__rendered();if(Ce=!1,Ie&&(Ie=!1,Ae=!0),Ve={},U=!1,v=!1,we)if(b){var V=document.getElementById(b.substring(1));V&&V.scrollIntoView()}else window.scrollTo(0,0);we=!0}},this.htmlentities=function(e){return e};var je=document.createElement("div");this.decode=function(e){return je.innerHTML=e,je.value}}var o=viewiGlobal.VIEWI_NO_ROUTER,r=o?null:n("Router"),i=n("ajax");e.Viewi=t})(viewiExports,viewiBring);